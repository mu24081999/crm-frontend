(self.webpackChunkclient=self.webpackChunkclient||[]).push([[2401],{92135:(e,s,a)=>{"use strict";a.d(s,{Z:()=>n});a(72791);var l=a(12202),i=a(80184);const n=function(e){let s,{fileType:a,fileUrl:n,fileWidth:t}=e;switch(a){case"jpeg":case"png":case"jpg":s=(0,i.jsx)("img",{className:"img-fluid rounded",style:{maxWidth:"300px"},src:n,width:t,alt:" preview"});break;case"pdf":s=(0,i.jsx)(l.yRW,{});break;case"zip":s=(0,i.jsx)(l.H5T,{});break;case"video":s=(0,i.jsxs)("video",{controls:!0,width:t,height:"auto",children:[(0,i.jsx)("source",{src:n,type:"video/mp4"}),"Your browser does not support the video tag."]});break;default:s=(0,i.jsx)(l.bz6,{color:"white",size:70,n:!0})}return(0,i.jsx)("div",{className:"",children:s})}},47596:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>L});var l=a(72791),i=a(34855),n=a(763),t=a.n(n),d=a(22316),r=a(80184);const c=e=>{let{rooms:s,authUser:a,socket:i,onDataFromChild:n,messages:c,deleteChatRecord:o,roomsLoading:h}=e;const[u,v]=(0,l.useState)("");function x(e){const s=null===e||void 0===e?void 0:e.charAt(0),a=null===e||void 0===e?void 0:e.indexOf(" ");return{firstCharacter:s,characterAfterSpace:-1!==a?e.charAt(a+1):""}}function m(e){const s=new Date(e),a=new Date,l=new Date(a);if(l.setDate(a.getDate()-1),s.toDateString()===a.toDateString())return"Today";if(s.toDateString()===l.toDateString())return"Yesterday";{const e={year:"numeric",month:"long",day:"numeric"};return s.toLocaleDateString("en-US",e)}}return(0,r.jsxs)("div",{children:[" ",h?(0,r.jsx)(d.Z,{}):(0,r.jsx)("ul",{class:"chat-contacts-list list-group list-group-flush",children:(null===s||void 0===s?void 0:s.length)>0?null===s||void 0===s?void 0:s.map(((e,s)=>{const a=null===c||void 0===c?void 0:c.filter((s=>s.room===e.room_id)),l=a[a.length-1];return(0,r.jsx)("li",{class:"list-group-item",onClick:()=>(e=>{n(e),i.emit("joinRoom",{roomId:e.room_id})})(e),children:(0,r.jsxs)("div",{class:"media",children:[(0,r.jsx)("div",{class:"media-head",children:(0,r.jsx)("div",{class:"avatar avatar-sm avatar-rounded position-relative",children:(0,r.jsx)("span",{class:"initial-wrap bg-primary",style:{color:"white"},children:t().capitalize(x(null===e||void 0===e?void 0:e.name).firstCharacter)+t().capitalize(x(null===e||void 0===e?void 0:e.name).characterAfterSpace)})})}),(0,r.jsxs)("div",{class:"media-body",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{class:"user-name",children:t().capitalize(null===e||void 0===e?void 0:e.name)}),(0,r.jsx)("div",{class:"user-last-chat",children:void 0!==l&&l.message})]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{class:"last-chat-time",children:null!==l&&void 0!==l&&l.created_at?m((null===l||void 0===l?void 0:l.created_at)||new Date):"..."})})]})]})},s)})):(0,r.jsx)("li",{children:"No rooms till."})})]})};var o=a(12202),h=a(94420);const u=e=>{let{rooms:s,authUser:a,socket:l,onDataFromChild:i,messages:n,deleteChatRecord:t,roomsLoading:d}=e;const{users:u}=(0,h.v9)((e=>e.user));function v(e){const s=null===e||void 0===e?void 0:e.charAt(0),a=null===e||void 0===e?void 0:e.indexOf(" ");return{firstCharacter:s,characterAfterSpace:-1!==a?e.charAt(a+1):""}}return(0,r.jsxs)("div",{children:[" ",(0,r.jsxs)("div",{class:"chatapp-aside",children:[(0,r.jsxs)("header",{class:"aside-header",children:[(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"fw-bold fs-4",children:"Groups"})}),(0,r.jsx)("div",{class:"d-flex",children:(0,r.jsx)("a",{href:"/",class:"btn btn-icon btn-rounded btn-primary","data-bs-toggle":"modal","data-bs-target":"#invite_people",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)(o.wEH,{})})})})})]}),(0,r.jsxs)("div",{"data-simplebar":!0,class:"aside-body",children:[(0,r.jsx)("div",{class:"frequent-contact",children:(0,r.jsx)("ul",{class:"hk-list",children:(null===u||void 0===u?void 0:u.length)>0&&u.map(((e,s)=>s.length<=4&&(0,r.jsx)("li",{children:(0,r.jsxs)("div",{class:"avatar avatar-sm avatar-primary position-relative avatar-rounded",children:[(0,r.jsx)("span",{class:"initial-wrap",children:v(e.name).firstCharacter+v(e.name).characterAfterSpace}),(0,r.jsxs)("div",{class:"badge-icon badge-circle badge-icon-xxs text-white position-bottom-end-overflow-1",children:[(0,r.jsx)("div",{class:"badge-icon-wrap",children:(0,r.jsx)("i",{class:"ri-group-fill text-light"})}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 127 127",children:(0,r.jsxs)("g",{"data-name":"Ellipse 302",transform:"translate(8 8)","stroke-width":"3",children:[(0,r.jsx)("circle",{cx:"55.5",cy:"55.5",r:"55.5",stroke:"currentColor"}),(0,r.jsx)("circle",{cx:"55.5",cy:"55.5",r:"59.5",fill:"currentColor"})]})})]})]})},s)))})}),(0,r.jsx)(c,{rooms:s,authUser:a,socket:l,onDataFromChild:i,messages:n,deleteChatRecord:t,roomsLoading:d})]})]})]})};var v=a(72426),x=a.n(v),m=a(74912),p=a.n(m),j=a(92135),f=a(29750),b=a(98911),g=a(13974);const y=e=>{var s;let{messages:a,selectedRoom:i,authUser:n,socket:d}=e;const{me:c,calling:u,readyForCall:v,readyForAudioCall:m,call:y,callUser:k}=(0,l.useContext)(f.J),[w,_]=(0,l.useState)(null),[C,S]=(0,l.useState)(null),{users:U}=(0,h.v9)((e=>e.user)),{token:I}=(0,h.v9)((e=>e.auth)),A=(0,h.I0)();function R(e){const s=null===e||void 0===e?void 0:e.charAt(0),a=null===e||void 0===e?void 0:e.indexOf(" ");return{firstCharacter:s,characterAfterSpace:-1!==a?e.charAt(a+1):""}}(0,l.useEffect)((()=>{}),[w,n,k,y,c,I]),(0,l.useEffect)((()=>{(null===a||void 0===a?void 0:a.length)>0&&document.getElementById("dummy_avatar").scrollIntoView({behavior:"smooth",block:"end"})}),[a]),(0,l.useEffect)((()=>{(null===U||void 0===U?void 0:U.length)>0&&S(U)}),[U]),(0,l.useEffect)((()=>{I&&A((0,b.Rf)(I))}),[I,A]),(0,l.useEffect)((()=>{const e=i.user_id_1===n.id?i.user_id_2:i.user_id_1;if((null===C||void 0===C?void 0:C.length)>0){const s=null===C||void 0===C?void 0:C.filter((s=>s.id===e));_(s[0])}}),[C,n,i]);const[z,N]=(0,l.useState)(null),[D,E]=(0,l.useState)(null),[T,L]=(0,l.useState)([]),[F,V]=(0,l.useState)(),Z=()=>{let e;e=z?{sender:n.id,recipient:i&&(null===i||void 0===i?void 0:i.user_id_1)===(null===n||void 0===n?void 0:n.id)?i.user_id_2:null===i||void 0===i?void 0:i.user_id_1,room:null===i||void 0===i?void 0:i.room_id,file_name:z.name,file_data:z,file_size:z.size,file_type:z.type,type:"file"}:{sender:n.id,room:null===i||void 0===i?void 0:i.room_id,message:F,type:"text"},d.emit("chat_message",e),V(""),N(null),E(null),document.getElementById("dummy_avatar").scrollIntoView({behavior:"smooth",block:"end"})},B=async(e,s)=>{const a=new(p().S3),l={Bucket:e,Key:s};try{const e=await a.getObject(l).promise(),i=URL.createObjectURL(new Blob([e.Body])),n=document.createElement("a");n.href=i,n.setAttribute("download",s),document.body.appendChild(n),n.click(),document.body.removeChild(n)}catch(i){console.error("Error downloading file:",i)}},M=e=>null===T||void 0===T?void 0:T.filter((s=>s.Key===e));function O(e){return null===e||void 0===e?void 0:e.split(".").pop().toLowerCase()}return(0,r.jsxs)("div",{class:"chatapp-single-chat",children:[(0,r.jsxs)("header",{class:"chat-header",children:[(0,r.jsx)("a",{id:"back_user_list",class:"btn btn-sm btn-icon btn-flush-dark btn-rounded flush-soft-hover back-user-list",href:"/",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)(o.bUI,{})})})}),(0,r.jsxs)("div",{class:"media",children:[(0,r.jsx)("div",{class:"media-head",children:(0,r.jsx)("div",{class:"avatar avatar-sm avatar-rounded position-relative",children:(0,r.jsx)("span",{class:"initial-wrap bg-primary",style:{color:"white"},children:t().capitalize(R(null===i||void 0===i?void 0:i.name).firstCharacter)+t().capitalize(R(null===i||void 0===i?void 0:i.name).characterAfterSpace)})})}),(0,r.jsx)("div",{class:"media-body",children:(0,r.jsxs)("div",{class:"user-name",children:[" ",null===i||void 0===i?void 0:i.name]})})]})]}),(0,r.jsx)("div",{"data-simplebar":!0,id:"chat_body",class:"chat-body",children:(0,r.jsx)("ul",{id:"dummy_avatar",class:"list-unstyled chat-single-list",children:(null===a||void 0===a?void 0:a.length)>0?a.map(((e,s)=>{var a;return t().toInteger(null===e||void 0===e?void 0:e.sender)!==(null===n||void 0===n?void 0:n.id)?(0,r.jsxs)("li",{class:"media received",children:[(0,r.jsx)("div",{children:(0,r.jsx)("span",{className:"badge bg-primary",children:null===e||void 0===e||null===(a=e.sender_info)||void 0===a?void 0:a.username})}),(0,r.jsx)("div",{class:"media-body",children:(0,r.jsxs)("div",{class:"msg-box",children:[(0,r.jsxs)("div",{children:[(null===e||void 0===e?void 0:e.file_key)&&(0,r.jsx)("button",{style:{border:"none",background:"none"},onClick:()=>{var s;return B("jampackcrm",null===(s=M(e.file_key)[0])||void 0===s?void 0:s.Key)},children:(0,r.jsx)(j.Z,{fileType:O(null===e||void 0===e?void 0:e.file_key),fileUrl:"https://s3.eu-west-2.amazonaws.com/jampackcrm/".concat(null===e||void 0===e?void 0:e.file_key)})}),(0,r.jsx)("p",{children:null===e||void 0===e?void 0:e.message}),(0,r.jsxs)("span",{class:"chat-time",children:[x()(null===F||void 0===F?void 0:F.created_at).format("h:mm A"),(0,r.jsxs)("span",{className:"float-end",children:[" ",(null===e||void 0===e?void 0:e.file_key)&&((null===e||void 0===e?void 0:e.file_size)/1048576).toFixed(2)+" mb"]})]})]}),(0,r.jsxs)("div",{class:"msg-action",children:[(0,r.jsx)("a",{href:"/",class:"btn btn-icon btn-flush-dark btn-rounded flush-soft-hover no-caret",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"corner-up-right"})})})}),(0,r.jsx)("a",{href:"/",class:"btn btn-icon btn-flush-dark btn-rounded flush-soft-hover dropdown-toggle no-caret","data-bs-toggle":"dropdown",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"more-horizontal"})})})}),(0,r.jsxs)("div",{class:"dropdown-menu dropdown-menu-end",children:[(0,r.jsx)("a",{class:"dropdown-item",href:"/",children:"Forward"}),(0,r.jsx)("a",{class:"dropdown-item",href:"/",children:"Copy"})]})]})]})})]},s):(0,r.jsx)("li",{class:"media sent",children:(0,r.jsx)("div",{class:"media-body",children:(0,r.jsxs)("div",{class:"msg-box",children:[(0,r.jsxs)("div",{children:[(null===e||void 0===e?void 0:e.file_key)&&(0,r.jsx)("button",{style:{border:"none",background:"none"},onClick:()=>{var s;return B("jampackcrm",null===(s=M(e.file_key)[0])||void 0===s?void 0:s.Key)},children:(0,r.jsx)(j.Z,{fileType:O(null===e||void 0===e?void 0:e.file_key),fileUrl:"https://s3.eu-west-2.amazonaws.com/jampackcrm/".concat(null===e||void 0===e?void 0:e.file_key)})}),(0,r.jsx)("p",{children:null===e||void 0===e?void 0:e.message}),(0,r.jsxs)("span",{class:"chat-time",children:[x()(null===F||void 0===F?void 0:F.created_at).format("h:mm A"),(0,r.jsxs)("span",{className:"float-end",children:[" ",(null===e||void 0===e?void 0:e.file_key)&&((null===e||void 0===e?void 0:e.file_size)/1048576).toFixed(2)+" mb"]})]})]}),(0,r.jsxs)("div",{class:"msg-action",children:[(0,r.jsx)("a",{href:"/",class:"btn btn-icon btn-flush-dark btn-rounded flush-soft-hover no-caret",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"corner-up-right"})})})}),(0,r.jsx)("a",{href:"/",class:"btn btn-icon btn-flush-dark btn-rounded flush-soft-hover dropdown-toggle no-caret","data-bs-toggle":"dropdown",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"more-horizontal"})})})}),(0,r.jsxs)("div",{class:"dropdown-menu dropdown-menu-end",children:[(0,r.jsx)("a",{class:"dropdown-item",href:"/",children:"Forward"}),(0,r.jsx)("a",{class:"dropdown-item",href:"/",children:"Copy"})]})]})]})})},s)})):(0,r.jsx)("li",{children:" No Messages"})})}),(0,r.jsxs)("footer",{class:"chat-footer d-flex gap-2",children:[(0,r.jsx)("div",{children:null!==D&&(0,r.jsx)("div",{className:"rounded",children:(0,r.jsx)("img",{src:D?URL.createObjectURL(D):"",alt:"image",className:"avatar-img",width:50})})}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{className:"btn btn-secondary shadow rounded-circle  float-end",style:{width:"35px",height:"35px"},onClick:()=>document.getElementById("dummy_avatar").scrollIntoView({behavior:"smooth",block:"end"}),children:(0,r.jsx)(o.NWQ,{style:{marginLeft:"-7px",marginBottom:"4px"}})})}),(0,r.jsxs)("div",{className:"btn shadow btn-primary rounded-circle btn-file",style:{width:"30px",height:"35px"},children:[(0,r.jsx)(g.UH,{size:17,style:{marginLeft:"-8px",marginBottom:"6px"}}),(0,r.jsx)("input",{type:"file",className:"upload",onChange:e=>{N(e.target.files[0]),E(e.target.files[0])}})]}),(0,r.jsx)("div",{class:"input-group",children:(0,r.jsxs)("span",{class:"input-affix-wrapper",children:[(0,r.jsx)("input",{type:"text",name:"send-msg",class:"input-msg-send form-control rounded-input",placeholder:"Type your message...",value:F,onChange:e=>V(e.target.value),onKeyUp:e=>"Enter"===e.key&&Z()}),(0,r.jsx)("span",{class:"input-suffix",children:(0,r.jsx)("button",{class:"btn btn-icon btn-flush-primary btn-rounded btn-send",onClick:Z,children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)(o.Rdr,{})})})})]})})]}),(0,r.jsx)("div",{class:"chat-info",children:(0,r.jsxs)("div",{"data-simplebar":!0,class:"nicescroll-bar",children:[(0,r.jsx)("button",{type:"button",class:"info-close btn-close",children:(0,r.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}),(0,r.jsxs)("div",{class:"text-center",children:[(0,r.jsx)("div",{class:"avatar avatar-xxl avatar-rounded position-relative",children:(0,r.jsx)("span",{class:"initial-wrap bg-primary",style:{color:"white"},children:t().capitalize(R(null===i||void 0===i?void 0:i.name).firstCharacter)+t().capitalize(R(null===i||void 0===i?void 0:i.name).characterAfterSpace)})}),(0,r.jsx)("div",{class:"cp-name text-truncate mt-2",children:null===i||void 0===i?void 0:i.name}),(0,r.jsx)("p",{class:"text-truncate",children:"No phone calls Always busy"})]}),(0,r.jsx)("ul",{class:"nav nav-justified nav-light nav-tabs nav-segmented-tabs active-theme mt-4",children:(0,r.jsx)("li",{class:"nav-item",children:(0,r.jsx)("a",{class:"nav-link active","data-bs-toggle":"tab",href:"#tab_info",children:(0,r.jsx)("span",{class:"nav-link-text",children:"Info"})})})}),(0,r.jsx)("div",{class:"tab-content mt-4",children:(0,r.jsx)("div",{class:"tab-pane fade show active",id:"tab_info",children:(0,r.jsx)("div",{class:"collapse-simple mt-3",children:(0,r.jsxs)("div",{class:"card",children:[(0,r.jsx)("div",{class:"card-header",children:(0,r.jsx)("a",{role:"button","data-bs-toggle":"collapse",href:"/gn_info","aria-expanded":"true",children:"Group Members"})}),(0,r.jsx)("div",{id:"gn_info",class:"collapse show",children:(0,r.jsx)("ul",{className:"p-1",style:{height:"200px",overflow:"scroll"},children:null!==i&&void 0!==i&&i.group_members?null===(s=JSON.parse(null===i||void 0===i?void 0:i.group_members).members)||void 0===s?void 0:s.map(((e,s)=>(0,r.jsx)("li",{children:(0,r.jsxs)("div",{class:"media d-flex align-items-center py-1",children:[(0,r.jsx)("div",{class:"media-head me-3",children:(0,r.jsx)("div",{class:"avatar avatar-sm avatar-rounded",children:(0,r.jsx)("img",{src:e.avatar||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg",alt:"user",class:"avatar-img"})})}),(0,r.jsx)("div",{class:"media-body",children:(0,r.jsx)("div",{class:"user-name",children:e.name})})]})},s))):(0,r.jsx)("li",{children:"No users found."})})})]})})})})]})})]})},k=()=>(0,r.jsxs)("div",{children:[" ",(0,r.jsx)("div",{id:"audio_call",class:"modal fade",tabIndex:"-1",role:"dialog","aria-hidden":"true",children:(0,r.jsx)("div",{class:"modal-dialog modal-dialog-centered modal-xl chatapp-call-window",role:"document",children:(0,r.jsxs)("div",{class:"modal-content",children:[(0,r.jsxs)("div",{class:"modal-header header-wth-bg",children:[(0,r.jsx)("h6",{class:"modal-title text-muted",children:"Jampack Audio Call"}),(0,r.jsxs)("div",{class:"modal-action",children:[(0,r.jsx)("a",{href:"/",class:"btn btn-xs btn-icon btn-flush-dark btn-rounded flush-soft-hover modal-fullscreen-togglable",children:(0,r.jsxs)("span",{class:"icon",children:[(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"maximize"})}),(0,r.jsx)("span",{class:"feather-icon d-none",children:(0,r.jsx)("i",{"data-feather":"minimize"})})]})}),(0,r.jsx)("a",{href:"/",class:"btn btn-xs btn-icon btn-flush-dark btn-rounded flush-soft-hover",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"help-circle"})})})})]})]}),(0,r.jsxs)("div",{class:"modal-body",children:[(0,r.jsx)("div",{class:"avatar avatar-xxxl avatar-rounded d-20",children:(0,r.jsx)("img",{src:"dist/img/avatar8.jpg",alt:"user",class:"avatar-img"})}),(0,r.jsx)("h3",{class:"mt-3",children:"Huma Therman"}),(0,r.jsxs)("p",{children:["Audio Calling",(0,r.jsx)("span",{class:"one",children:"."}),(0,r.jsx)("span",{class:"two",children:"."}),(0,r.jsx)("span",{class:"three",children:"."})]})]}),(0,r.jsxs)("div",{class:"modal-footer",children:[(0,r.jsxs)("ul",{class:"chatapp-call-action hk-list",children:[(0,r.jsx)("li",{children:(0,r.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-soft-light",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"mic"})})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-soft-light",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"video"})})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-danger","data-bs-dismiss":"modal",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"phone"})})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-soft-light",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"user-plus"})})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-soft-light",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"more-vertical"})})})})})]}),(0,r.jsx)("div",{class:"avatar avatar-lg avatar-rounded chatapp-caller-img",children:(0,r.jsx)("img",{src:"dist/img/avatar13.jpg",alt:"user",class:"avatar-img"})})]})]})})})]}),w=e=>{let{selectedRoom:s,authUser:a,socket:i}=e;const{isCalling:n,callAccepted:t,stream:d,myVideo:c,call:u,answerCall:v,ringing:x,userVideo:m,callEnded:p,leaveCall:j,openCalling:g,callUser:y,readyForCall:k,type:w}=(0,l.useContext)(f.J);console.log("\ud83d\ude80 ~ VideoCall ~ type:",w);const[_,C]=(0,l.useState)(null),[S,U]=(0,l.useState)(null),{users:I}=(0,h.v9)((e=>e.user)),{token:A}=(0,h.v9)((e=>e.auth)),R=(0,h.I0)(),z=(0,l.useCallback)((()=>{n||u.isRecieving||!g||y(null===_||void 0===_?void 0:_.socket_id,a.name,w)}),[y,_,a,n,u,g,w]);return(0,l.useMemo)((()=>{z()}),[z]),(0,l.useEffect)((()=>{(null===I||void 0===I?void 0:I.length)>0&&U(I)}),[I]),(0,l.useEffect)((()=>{A&&R((0,b.Rf)(A))}),[A,R]),(0,l.useEffect)((()=>{const e=s.user_id_1===a.id?s.user_id_2:s.user_id_1;if((null===S||void 0===S?void 0:S.length)>0){const s=null===S||void 0===S?void 0:S.filter((s=>s.id===e));C(s[0])}}),[S,a,s]),(0,r.jsx)("div",{children:(0,r.jsx)("div",{id:"video_call",class:"modal",tabIndex:"-1",role:"dialog",togg:"modal","aria-hidden":"true",children:(0,r.jsx)("div",{class:"modal-dialog modal-dialog-centered modal-xl chatapp-call-window",role:"document",children:(0,r.jsxs)("div",{class:"modal-content bg-primary-dark-5",children:[(0,r.jsxs)("div",{class:"modal-header header-wth-bg bg-primary-dark-3",children:[(0,r.jsx)("h6",{class:"modal-title text-muted",children:"Jampack Video Call"}),(0,r.jsxs)("div",{class:"modal-action",children:[(0,r.jsx)("a",{href:"/",class:"btn btn-xs btn-icon btn-rounded btn-link link-secondary modal-fullscreen-togglable",children:(0,r.jsxs)("span",{class:"icon",children:[(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"maximize"})}),(0,r.jsx)("span",{class:"feather-icon d-none",children:(0,r.jsx)("i",{"data-feather":"minimize"})})]})}),(0,r.jsx)("a",{href:"/",class:"btn btn-xs btn-icon btn-rounded btn-link link-secondary",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"help-circle"})})})})]})]}),(0,r.jsx)("div",{class:"text-center m-auto",children:!t||"audio"===w&&(0,r.jsx)("div",{class:"avatar avatar-xxxl avatar-rounded d-20 ",children:(0,r.jsx)("img",{src:s.user_id_1===(null===a||void 0===a?void 0:a.id)?s.user_image_2:s.user_image_1,alt:"user",className:"avatar-img m-auto"})})}),t&&!p&&(0,r.jsx)("video",{playsInline:!0,ref:m,autoPlay:!0,style:{},className:"video-container"}),(0,r.jsxs)("div",{class:"modal-footer position-absolute bottom-0 w-100",children:[(0,r.jsxs)("div",{className:"d-flex justify-content-center w-100",children:[(0,r.jsxs)("ul",{class:"chatapp-call-action hk-list",children:[(0,r.jsx)("li",{children:(0,r.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-dark",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"mic"})})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-dark",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"video"})})})})}),!0===u.isReceivingCall&&x&&!t?(0,r.jsx)("li",{children:(0,r.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-success",onClick:v,children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)(o.I7T,{})})})})}):(0,r.jsx)("li",{children:(0,r.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-danger","data-bs-dismiss":"modal",onClick:()=>j(_.socket_id),children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)(o.I7T,{})})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-dark",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"user-plus"})})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-dark",children:(0,r.jsx)("span",{class:"icon",children:(0,r.jsx)("span",{class:"feather-icon",children:(0,r.jsx)("i",{"data-feather":"more-vertical"})})})})})]}),(0,r.jsxs)("div",{class:"avatar avatar-lg avatar-rounded chatapp-caller-img ",children:[d&&(0,r.jsx)("video",{playsInline:!0,muted:!0,ref:c,autoPlay:!0,width:"140",height:"150"}),"audio"===w&&(0,r.jsx)("img",{src:s.user_id_1===(null===a||void 0===a?void 0:a.id)?s.user_image_1:s.user_image_2,alt:"user",class:"avatar-img"})]})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h3",{class:"text-white mt-3",children:s.user_id_1===(null===a||void 0===a?void 0:a.id)?s.user_name_2:s.user_name_1}),!t&&(0,r.jsxs)("p",{class:"text-white",children:["Video Calling",(0,r.jsx)("span",{class:"one",children:"."}),(0,r.jsx)("span",{class:"two",children:"."}),(0,r.jsx)("span",{class:"three",children:"."})]})]})]})]})})})})},_={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let C;const S=new Uint8Array(16);function U(){if(!C&&(C="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!C))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return C(S)}const I=[];for(let F=0;F<256;++F)I.push((F+256).toString(16).slice(1));function A(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return I[e[s+0]]+I[e[s+1]]+I[e[s+2]]+I[e[s+3]]+"-"+I[e[s+4]]+I[e[s+5]]+"-"+I[e[s+6]]+I[e[s+7]]+"-"+I[e[s+8]]+I[e[s+9]]+"-"+I[e[s+10]]+I[e[s+11]]+I[e[s+12]]+I[e[s+13]]+I[e[s+14]]+I[e[s+15]]}const R=function(e,s,a){if(_.randomUUID&&!s&&!e)return _.randomUUID();const l=(e=e||{}).random||(e.rng||U)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,s){a=a||0;for(let e=0;e<16;++e)s[a+e]=l[e];return s}return A(l)},z=e=>{let{users:s,authUser:a,socket:i}=e;const{createGroupChatRooms:n}=(0,l.useContext)(f.J),[d,c]=(0,l.useState)([]),[o,h]=(0,l.useState)("");console.log("\ud83d\ude80 ~ InvitePeople ~ selectedUsers:",d);return(0,r.jsx)("div",{children:(0,r.jsx)("div",{class:"modal fade",id:"invite_people",tabindex:"-1",role:"dialog",children:(0,r.jsx)("div",{class:"modal-dialog modal-dialog-centered mw-400p",role:"document",children:(0,r.jsxs)("div",{class:"modal-content",children:[(0,r.jsxs)("div",{class:"modal-header header-wth-bg-inv",children:[(0,r.jsx)("h5",{class:"modal-title",children:"Invite People"}),(0,r.jsx)("button",{type:"button",class:"btn-close text-white","data-bs-dismiss":"modal","aria-label":"Close",children:(0,r.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,r.jsxs)("div",{class:"modal-body p-0",children:[(0,r.jsx)("form",{class:"m-3",role:"search",children:(0,r.jsx)("input",{type:"text",class:"form-control rounded-input user-search",placeholder:"Search People"})}),(0,r.jsx)("div",{class:"h-350p",children:(0,r.jsx)("div",{"data-simplebar":!0,class:"nicescroll-bar",children:(0,r.jsx)("ul",{class:"invite-user-list",children:(null===s||void 0===s?void 0:s.length)>0?null===s||void 0===s?void 0:s.map(((e,s)=>(0,r.jsxs)("li",{children:[(0,r.jsxs)("div",{class:"media d-flex align-items-center",children:[(0,r.jsx)("div",{class:"media-head me-3",children:(0,r.jsx)("div",{class:"avatar avatar-sm avatar-rounded",children:(0,r.jsx)("img",{src:e.avatar||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg",alt:"user",class:"avatar-img"})})}),(0,r.jsx)("div",{class:"media-body",children:(0,r.jsx)("div",{class:"user-name",children:e.name})})]}),(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"checkbox",class:"form-check-input",checked:d[e.id]||!1,onChange:()=>{return s=e.id,void c((e=>({...e,[s]:!e[s]})));var s}})})]},s))):(0,r.jsx)("li",{children:"No users found."})})})})]}),(0,r.jsxs)("div",{class:"form-group m-3",role:"search",children:[(0,r.jsx)("label",{className:"form-label",children:"Group Name"}),(0,r.jsx)("input",{type:"text",class:"form-control rounded-input user-search",onChange:e=>{h(e.target.value)},placeholder:"Search People"})]}),(0,r.jsxs)("div",{class:"modal-footer justify-content-center",children:[(0,r.jsx)("button",{type:"button",class:"btn flex-fill btn-light flex-1","data-bs-dismiss":"modal",children:"Cancel"}),(0,r.jsx)("button",{onClick:()=>{const e=[];Object.entries(d).map((a=>{let[l,i]=a;if(i){const a=null===s||void 0===s?void 0:s.filter((e=>e.id===t().toInteger(l)))[0];e.push(a)}}));const l=null===a||void 0===a?void 0:a.id,n=null===a||void 0===a?void 0:a.name,r=null===a||void 0===a?void 0:a.image,c={name:o,user_id:l,user_name:n,user_image:r,room_id:R(),group_members:{members:e}};i.emit("add-group-chat-room",c)},type:"button",class:"btn flex-fill btn-primary flex-1","data-bs-dismiss":"modal",children:"Create Group"})]})]})})})})};var N=a(91608),D=a(75985),E=a(55294);const T=()=>{const e="".concat("https://desktopcrm.com:51/v1"),s="https://desktopcrm.com:51",a=(0,l.useMemo)((()=>(0,N.ZP)(s)),[s]),[i,n]=(0,l.useState)({}),[d,c]=(0,l.useState)([]),[o,v]=(0,l.useState)([]),[x,m]=(0,l.useState)([]),[p,j]=(0,l.useState)([]),{user:f,token:g}=(0,h.v9)((e=>e.auth)),{users:_}=(0,h.v9)((e=>e.user)),[C,S]=(0,l.useState)([]),[U,I]=(0,l.useState)(!1),A=(0,h.I0)(),R=(0,l.useCallback)((async()=>{I(!0);try{const s={headers:{"Content-Type":"application/json","x-access-token":g}};await E.Z.get("".concat(e,"/user/chat/get-group-rooms"),s).then((e=>{S(e.data.data.chatRoomsData),I(!1)}))}catch(s){D.Am.error(s.message),I(!1)}}),[e,g]),T=(0,l.useCallback)((async s=>{try{const a={headers:{"Content-Type":"application/json","x-access-token":g}};await E.Z.get("".concat(e,"/user/chat/group-chat-history/").concat(s),a).then((e=>{var s,a,l,i;c(null===(s=e.data)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.chatData),v(null===(l=e.data)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.chatData)}))}catch(a){D.Am.error(a.message)}}),[e,g]);(0,l.useMemo)((()=>{i&&T(null===i||void 0===i?void 0:i.room_id)}),[i,T]);const L=(0,l.useCallback)((async s=>{try{const s={headers:{"Content-Type":"application/json","x-access-token":g}};await E.Z.get("".concat(e,"/user/chat/get-chats"),s).then((e=>{var s;j(null===(s=e.data)||void 0===s?void 0:s.data.chatData)}))}catch(a){D.Am.error(a.message)}}),[e,g]),F=(0,l.useCallback)((async s=>{try{const a={headers:{"Content-Type":"application/json","x-access-token":g}};await E.Z.delete("".concat(e,"/user/chat/delete-group-chat-history/").concat(s),a).then((e=>{console.log("\ud83d\ude80 ~ .then ~ response:",e),R()}))}catch(a){D.Am.error(a.message)}}),[e,g,R]);(0,l.useMemo)((()=>{null!==i&&void 0!==i&&i.id&&T(null===i||void 0===i?void 0:i.room_id)}),[T,i]),(0,l.useEffect)((()=>{g&&(R(),L(),A((0,b.Rf)(g)))}),[g,A,R,L]),(0,l.useEffect)((()=>{a.on("message_added",(e=>{c(e)})),a.on("group_room_added",(()=>{R()}))}),[a,R]),(0,l.useEffect)((()=>{if((null===_||void 0===_?void 0:_.length)>0){const e=null===_||void 0===_?void 0:_.filter((e=>t().toInteger(e.parent_id)===f.id||t().toInteger(e.client_id)===f.id));m(e)}}),[_,f]),(0,l.useEffect)((()=>{if((null===_||void 0===_?void 0:_.length)>0&&(null===d||void 0===d?void 0:d.length)>0){const e=[];null===d||void 0===d||d.forEach((s=>{s.sender_info=null===_||void 0===_?void 0:_.filter((e=>e.id===t().toInteger(s.sender)))[0],e.push(s)})),console.log("\ud83d\ude80 ~ newMessages ~ newMessages:",e),v(e)}}),[_,d]);return(0,r.jsx)("div",{children:(0,r.jsx)("div",{class:"hk-pg-wrapper pb-0",children:(0,r.jsx)("div",{class:"hk-pg-body py-0",children:(0,r.jsx)("div",{class:"chatapp-wrap chatapp-info-active",children:(0,r.jsxs)("div",{class:"chatapp-content",children:[(0,r.jsx)(u,{socket:a,rooms:C,authUser:f,onDataFromChild:e=>{n(e)},messages:p,deleteChatRecord:F,roomsLoading:U}),(null===i||void 0===i?void 0:i.id)&&(0,r.jsx)(y,{messages:o,selectedRoom:i,authUser:f,socket:a}),(0,r.jsx)(k,{socket:a,authUser:f,selectedRoom:i}),(0,r.jsx)(w,{socket:a,authUser:f,selectedRoom:i}),(0,r.jsx)(z,{users:x,authUser:f,socket:a})]})})})})})},L=()=>(0,r.jsx)("div",{children:(0,r.jsx)(i.Z,{component:(0,r.jsx)(T,{})})})},28022:()=>{}}]);
//# sourceMappingURL=2401.c7a1b9a2.chunk.js.map