(self.webpackChunkclient=self.webpackChunkclient||[]).push([[1490],{92135:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});a(72791);var i=a(12202),n=a(80184);const t=function(e){let s,{fileType:a,fileUrl:t,fileWidth:l}=e;switch(a){case"jpeg":case"png":case"jpg":s=(0,n.jsx)("img",{className:"img-fluid rounded",style:{maxWidth:"300px"},src:t,width:l,alt:" preview"});break;case"pdf":s=(0,n.jsx)(i.yRW,{});break;case"zip":s=(0,n.jsx)(i.H5T,{});break;case"video":s=(0,n.jsxs)("video",{controls:!0,width:l,height:"auto",children:[(0,n.jsx)("source",{src:t,type:"video/mp4"}),"Your browser does not support the video tag."]});break;default:s=(0,n.jsx)(i.bz6,{color:"white",size:70,n:!0})}return(0,n.jsx)("div",{className:"",children:s})}},85474:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>I});var i=a(72791),n=a(34855),t=a(94420),l=a(22316),d=a(80184);const o=e=>{let{rooms:s,authUser:a,socket:i,onDataFromChild:n,messages:o,deleteChatRecord:c,updateChat:r,roomsLoading:u}=e;const{users:h}=(0,t.v9)((e=>e.user));function v(e){const s=new Date(e),a=new Date,i=new Date(a);if(i.setDate(a.getDate()-1),s.toDateString()===a.toDateString())return"Today";if(s.toDateString()===i.toDateString())return"Yesterday";{const e={year:"numeric",month:"long",day:"numeric"};return s.toLocaleDateString("en-US",e)}}return(0,d.jsxs)("div",{children:[" ",u?(0,d.jsx)(l.Z,{}):(0,d.jsx)("ul",{class:"chat-contacts-list list-group list-group-flush",children:(null===s||void 0===s?void 0:s.length)>0?null===s||void 0===s?void 0:s.map(((e,s)=>{var t;const l=null===o||void 0===o?void 0:o.filter((s=>s.room===e.name)),c=l[l.length-1];return(0,d.jsx)("li",{class:"list-group-item",onClick:()=>(e=>{console.log("\ud83d\ude80 ~ roomClickHandler ~ room:",e),n(e),i.emit("joinRoom",{roomId:e.name})})(e),children:(0,d.jsxs)("div",{class:"media",children:[(0,d.jsx)("div",{class:"media-head",children:(0,d.jsxs)("div",{class:"avatar avatar-sm avatar-rounded position-relative",children:[(0,d.jsx)("img",{src:(e.user_id_1===(null===a||void 0===a?void 0:a.id)?e.user_image_2:e.user_image_1)||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg",alt:"user",class:"avatar-img"}),1===(null===(r=e.user_id_1===(null===a||void 0===a?void 0:a.id)?e.user_id_2:e.user_id_1,t=null===h||void 0===h?void 0:h.filter((e=>e.id===parseInt(r)))[0])||void 0===t?void 0:t.connected)&&(0,d.jsx)("span",{class:"badge badge-success badge-indicator badge-indicator-lg position-bottom-end-overflow-1"})]})}),(0,d.jsxs)("div",{class:"media-body",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{class:"user-name",children:[" ",e.user_id_1===(null===a||void 0===a?void 0:a.id)?e.user_name_2:e.user_name_1," "]}),(0,d.jsx)("div",{class:"user-last-chat",children:void 0!==c&&c.message})]}),(0,d.jsx)("div",{children:(0,d.jsx)("div",{class:"last-chat-time",children:null!==c&&void 0!==c&&c.created_at?v((null===c||void 0===c?void 0:c.created_at)||new Date):"..."})})]})]})},s);var r})):(0,d.jsx)("li",{children:"No rooms till."})})]})};var c=a(12202);const r=e=>{let{rooms:s,authUser:a,socket:i,onDataFromChild:n,messages:l,deleteChatRecord:r,updateChat:u,onFilterDataFromChild:h,rooms_:v,roomsLoading:m}=e;const{users:x}=(0,t.v9)((e=>e.user));return(0,d.jsxs)("div",{children:[" ",(0,d.jsxs)("div",{class:"chatapp-aside",children:[(0,d.jsxs)("header",{class:"aside-header",children:[(0,d.jsx)("h1",{className:"fs-5 fw-bold",children:"Chat"}),(0,d.jsxs)("div",{class:"d-flex",children:[(0,d.jsx)("div",{class:"dropdown",children:(0,d.jsxs)("div",{class:"dropdown-menu dropdown-menu-end",children:[(0,d.jsxs)("a",{class:"dropdown-item",href:"/",children:[(0,d.jsx)("span",{class:"feather-icon dropdown-icon",children:(0,d.jsx)(c.TZR,{})}),(0,d.jsx)("span",{children:"Active Contacts"})]}),(0,d.jsxs)("a",{class:"dropdown-item",href:"/",children:[(0,d.jsx)("span",{class:"feather-icon dropdown-icon",children:(0,d.jsx)("i",{"data-feather":"message-square"})}),(0,d.jsx)("span",{children:"Chat Requests"})]}),(0,d.jsxs)("a",{class:"dropdown-item",href:"/",children:[(0,d.jsx)("span",{class:"feather-icon dropdown-icon",children:(0,d.jsx)("i",{"data-feather":"archive"})}),(0,d.jsx)("span",{children:"Archived Chats"})]}),(0,d.jsxs)("a",{class:"dropdown-item",href:"/",children:[(0,d.jsx)("span",{class:"feather-icon dropdown-icon",children:(0,d.jsx)("i",{"data-feather":"toggle-right"})}),(0,d.jsx)("span",{children:"Unread Chats"})]}),(0,d.jsx)("div",{class:"dropdown-divider"}),(0,d.jsx)("a",{class:"dropdown-item",href:"/",children:"Settings"}),(0,d.jsx)("a",{class:"dropdown-item",href:"/",children:"Help"}),(0,d.jsxs)("a",{class:"dropdown-item",href:"/",children:["Report a problem"," "]})]})}),(0,d.jsx)("a",{href:"/",class:"btn btn-icon btn-rounded btn-primary","data-bs-toggle":"modal","data-bs-target":"#invite_people",children:(0,d.jsx)("span",{class:"icon",children:(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)(c.wEH,{})})})})]})]}),(0,d.jsx)("div",{"data-simplebar":!0,class:"aside-body",children:(0,d.jsx)(o,{rooms:s,authUser:a,socket:i,onDataFromChild:n,messages:l,deleteChatRecord:r,updateChat:u,roomsLoading:m})})]})]})};var u=a(763),h=a.n(u),v=a(72426),m=a.n(v),x=a(92135),p=a(29750),j=a(98911),f=a(13974),g=a(64802),b=a(55294);const _=e=>{var s;let{messages:a,selectedRoom:n,authUser:l,socket:o}=e;const{pushNotification:r}=(0,i.useContext)(p.J),[u,v]=(0,i.useState)(null),[_,y]=(0,i.useState)(null),{users:w}=(0,t.v9)((e=>e.user)),{token:k}=(0,t.v9)((e=>e.auth)),C=(0,t.I0)(),R=e=>null===w||void 0===w?void 0:w.filter((s=>s.id===parseInt(e)))[0];(0,i.useEffect)((()=>{(null===a||void 0===a?void 0:a.length)>0&&document.getElementById("dummy_avatar").scrollIntoView({behavior:"smooth",block:"end"})}),[a]);const E=async(e,s)=>{try{const a=await b.Z.get(e,{responseType:"blob"}),i=new Blob([a.data]);(0,g.saveAs)(i,s)}catch(a){console.error("Error downloading file:",a)}};(0,i.useEffect)((()=>{(null===w||void 0===w?void 0:w.length)>0&&y(w)}),[w]),(0,i.useEffect)((()=>{k&&C((0,j.Rf)(k))}),[k,C]),(0,i.useEffect)((()=>{const e=n.user_id_1===l.id?n.user_id_2:n.user_id_1;if((null===_||void 0===_?void 0:_.length)>0){const s=null===_||void 0===_?void 0:_.filter((s=>s.id===e));v(s[0])}}),[_,l,n]);const[N,S]=(0,i.useState)(null),[U,A]=(0,i.useState)(null),[I,T]=(0,i.useState)([]),[D,L]=(0,i.useState)(),M=e=>{if("click"===e.type||"Enter"===e.key){var s,a;let e;if(N){const s=new FileReader;s.readAsArrayBuffer(N),s.onload=async e=>{const s=e.target.result,a={name:N.name,type:N.type,size:N.size,data:s};S(a)},e={sender:n&&(null===n||void 0===n?void 0:n.user_id_1)===(null===l||void 0===l?void 0:l.id)?n.user_id_1:null===n||void 0===n?void 0:n.user_id_2,recipient:n&&(null===n||void 0===n?void 0:n.user_id_1)===(null===l||void 0===l?void 0:l.id)?n.user_id_2:null===n||void 0===n?void 0:n.user_id_1,room:null===n||void 0===n?void 0:n.name,file:N,file_name:N.name,file_data:N,file_size:N.size,file_type:N.type,type:"file"}}else e={sender:n&&(null===n||void 0===n?void 0:n.user_id_1)===(null===l||void 0===l?void 0:l.id)?n.user_id_1:null===n||void 0===n?void 0:n.user_id_2,recipient:n&&(null===n||void 0===n?void 0:n.user_id_1)===(null===l||void 0===l?void 0:l.id)?n.user_id_2:null===n||void 0===n?void 0:n.user_id_1,room:null===n||void 0===n?void 0:n.name,message:D,type:"text"};o.emit("chat_message",e);const i=R(null===(s=e)||void 0===s?void 0:s.recipient),t=R(null===(a=e)||void 0===a?void 0:a.sender);r({user_id:null===i||void 0===i?void 0:i.id,notification:"You have a team message from ".concat(t.name),type:"team_message"}),L(""),S(null),A(null),document.getElementById("dummy_avatar").scrollIntoView({behavior:"smooth",block:"end"})}};function z(e){return null===e||void 0===e?void 0:e.split(".").pop().toLowerCase()}return(0,d.jsxs)("div",{class:"chatapp-single-chat",children:[(0,d.jsxs)("header",{class:"chat-header",children:[(0,d.jsx)("a",{id:"back_user_list",class:"btn btn-sm btn-icon btn-flush-dark btn-rounded flush-soft-hover back-user-list",href:"/",children:(0,d.jsx)("span",{class:"icon",children:(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)("i",{"data-feather":"chevron-left"})})})}),(0,d.jsxs)("div",{class:"media",children:[(0,d.jsx)("div",{class:"media-head",children:(0,d.jsxs)("div",{class:"avatar avatar-sm avatar-rounded position-relative",children:[(0,d.jsx)("img",{src:((null===n||void 0===n?void 0:n.user_id_1)===(null===l||void 0===l?void 0:l.id)?null===n||void 0===n?void 0:n.user_image_2:null===n||void 0===n?void 0:n.user_image_1)||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg",alt:"user",class:"avatar-img"}),1===(null===(s=R(n.user_id_1===(null===l||void 0===l?void 0:l.id)?n.user_id_2:n.user_id_1))||void 0===s?void 0:s.connected)&&(0,d.jsx)("span",{class:"badge badge-success badge-indicator badge-indicator-lg position-bottom-end-overflow-1"})]})}),(0,d.jsx)("div",{class:"media-body",children:(0,d.jsxs)("div",{class:"user-name",children:[" ",(null===n||void 0===n?void 0:n.user_id_1)===(null===l||void 0===l?void 0:l.id)?null===n||void 0===n?void 0:n.user_name_2:null===n||void 0===n?void 0:n.user_name_1]})})]}),(0,d.jsx)("div",{class:"chat-options-wrap",children:(0,d.jsx)("a",{class:"btn btn-icon btn-flush-dark btn-rounded flush-soft-hover dropdown-toggle no-caret d-none d-xl-block",href:"/","data-bs-toggle":"modal","data-bs-target":"#invite_people",children:(0,d.jsx)("span",{class:"icon","data-bs-toggle":"tooltip","data-bs-placement":"top",title:"","data-bs-original-title":"Invite people",children:(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)(c.Bj$,{})})})})})]}),(0,d.jsx)("div",{"data-simplebar":!0,id:"chat_body",class:"chat-body",children:(0,d.jsx)("ul",{id:"dummy_avatar",class:"list-unstyled chat-single-list",children:(null===a||void 0===a?void 0:a.length)>0?a.map(((e,s)=>{var a,i;return h().toInteger(null===e||void 0===e?void 0:e.sender)!==(null===l||void 0===l?void 0:l.id)?(0,d.jsxs)("li",{class:"media received",children:[(0,d.jsx)("div",{class:"avatar avatar-xs avatar-rounded",children:(0,d.jsx)("img",{src:(h().toInteger(e.recipient)===n.user_id_1?(null===n||void 0===n||null===(a=n.user_image_1)||void 0===a?void 0:a.includes("https"))&&(null===n||void 0===n?void 0:n.user_image_1):(null===n||void 0===n||null===(i=n.user_image_2)||void 0===i?void 0:i.includes("https"))&&(null===n||void 0===n?void 0:n.user_image_2))||"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQNL_ZnOTpXSvhf1UaK7beHey2BX42U6solRA&s",alt:"user",class:"avatar-img"})}),(0,d.jsx)("div",{class:"media-body",children:(0,d.jsx)("div",{class:"msg-box",children:(0,d.jsxs)("div",{children:[(null===e||void 0===e?void 0:e.file_key)&&(0,d.jsx)("button",{style:{border:"none",background:"none"},onClick:()=>{var s,a;return E("jampackcrm",null===(s=(a=e.file_key,null===I||void 0===I?void 0:I.filter((e=>e.Key===a)))[0])||void 0===s?void 0:s.Key)},children:(0,d.jsx)(x.Z,{fileType:z(null===e||void 0===e?void 0:e.file_key),fileUrl:"https://s3.eu-west-2.amazonaws.com/jampackcrm/".concat(null===e||void 0===e?void 0:e.file_key)})}),(0,d.jsx)("p",{children:e.message}),(0,d.jsxs)("span",{class:"chat-time",children:[m()(null===e||void 0===e?void 0:e.created_at).format("YYYY-MM-DD h:mm A"),(0,d.jsxs)("span",{className:"float-end",children:[" ",(null===e||void 0===e?void 0:e.file_key)&&((null===e||void 0===e?void 0:e.file_size)/1048576).toFixed(2)+" mb"]})]})]})})})]},s):(0,d.jsx)("li",{class:"media sent",children:(0,d.jsx)("div",{class:"media-body",children:(0,d.jsx)("div",{class:"msg-box",children:(0,d.jsxs)("div",{children:[(null===e||void 0===e?void 0:e.file_key)&&(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("a",{style:{border:"none",background:"none"},href:null===e||void 0===e?void 0:e.file_url,children:(0,d.jsx)(x.Z,{fileType:z(null===e||void 0===e?void 0:e.file_key),fileUrl:"https://s3.eu-west-2.amazonaws.com/jampackcrm/".concat(null===e||void 0===e?void 0:e.file_key)})})}),(0,d.jsx)("p",{children:e.message}),(0,d.jsxs)("span",{class:"chat-time",children:[m()(null===e||void 0===e?void 0:e.created_at).format("YYYY-MM-DD h:mm A"),(0,d.jsxs)("span",{className:"float-end",children:[" ",(null===e||void 0===e?void 0:e.file_key)&&((null===e||void 0===e?void 0:e.file_size)/1048576).toFixed(2)+" mb"]})]})]})})})},s)})):(0,d.jsx)("li",{children:" No Messages"})})}),(0,d.jsxs)("footer",{class:"chat-footer d-flex gap-2",children:[(0,d.jsx)("div",{children:null!==U&&(0,d.jsx)("div",{className:"rounded",children:(0,d.jsx)("img",{src:U?URL.createObjectURL(U):"",alt:"image",className:"avatar-img",width:50})})}),(0,d.jsx)("div",{children:(0,d.jsx)("button",{className:"btn btn-secondary shadow rounded-circle  float-end",style:{width:"35px",height:"35px"},onClick:()=>document.getElementById("dummy_avatar").scrollIntoView({behavior:"smooth",block:"end"}),children:(0,d.jsx)(c.NWQ,{style:{marginLeft:"-7px",marginBottom:"4px"}})})}),(0,d.jsxs)("div",{className:"btn shadow btn-primary rounded-circle btn-file",style:{width:"30px",height:"35px"},children:[(0,d.jsx)(f.UH,{size:17,style:{marginLeft:"-8px",marginBottom:"6px"}}),(0,d.jsx)("input",{type:"file",className:"upload",onChange:e=>{S(e.target.files[0]),A(e.target.files[0])}})]}),(0,d.jsx)("div",{class:"input-group",children:(0,d.jsxs)("span",{class:"input-affix-wrapper",children:[(0,d.jsx)("input",{type:"text",name:"send-msg",class:"input-msg-send form-control rounded-input",placeholder:"Type your message...",value:D,onChange:e=>L(e.target.value),onKeyUp:e=>"Enter"===e.key&&M(e)}),(0,d.jsx)("span",{class:"input-suffix",children:(0,d.jsx)("button",{class:"btn btn-icon btn-flush-primary btn-rounded btn-send",onClick:e=>M(e),children:(0,d.jsx)("span",{class:"icon",children:(0,d.jsx)(c.Rdr,{})})})})]})})]}),(0,d.jsx)("div",{class:"chat-info",children:(0,d.jsxs)("div",{"data-simplebar":!0,class:"nicescroll-bar",children:[(0,d.jsx)("button",{type:"button",class:"info-close btn-close",children:(0,d.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}),(0,d.jsxs)("div",{class:"text-center",children:[(0,d.jsx)("div",{class:"avatar avatar-xxl avatar-rounded",children:(0,d.jsx)("img",{src:((null===n||void 0===n?void 0:n.user_id_1)===(null===l||void 0===l?void 0:l.id)?null===n||void 0===n?void 0:n.user_image_2:null===n||void 0===n?void 0:n.user_image_1)||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg",alt:"user",class:"avatar-img"})}),(0,d.jsxs)("div",{class:"cp-name text-truncate mt-2",children:[" ",(null===n||void 0===n?void 0:n.user_id_1)===(null===l||void 0===l?void 0:l.id)?null===n||void 0===n?void 0:n.user_name_2:null===n||void 0===n?void 0:n.user_name_1]}),(0,d.jsx)("p",{class:"text-truncate",children:"No phone calls Always busy"})]}),(0,d.jsx)("ul",{class:"nav nav-justified nav-light nav-tabs nav-segmented-tabs active-theme mt-4",children:(0,d.jsx)("li",{class:"nav-item",children:(0,d.jsx)("a",{class:"nav-link active","data-bs-toggle":"tab",href:"#tab_info",children:(0,d.jsx)("span",{class:"nav-link-text",children:"Info"})})})}),(0,d.jsx)("div",{class:"tab-content mt-4",children:(0,d.jsx)("div",{class:"tab-pane fade show active",id:"tab_info",children:(0,d.jsx)("div",{class:"collapse-simple mt-3",children:(0,d.jsxs)("div",{class:"card",children:[(0,d.jsx)("div",{class:"card-header",children:(0,d.jsx)("a",{role:"button","data-bs-toggle":"collapse",href:"/gn_info","aria-expanded":"true",children:"General Info"})}),(0,d.jsx)("div",{id:"gn_info",class:"collapse show",children:(0,d.jsx)("div",{class:"card-body",children:(0,d.jsxs)("ul",{class:"cp-info",children:[(0,d.jsxs)("li",{className:"d-flex justify-content-between",children:[(0,d.jsx)("span",{className:"fw-bold fs-6",children:"Name"}),(0,d.jsx)("span",{children:null===u||void 0===u?void 0:u.name})]}),(0,d.jsxs)("li",{className:"d-flex justify-content-between",children:[(0,d.jsx)("span",{className:"fw-bold fs-6",children:"Email"}),(0,d.jsx)("span",{children:null===u||void 0===u?void 0:u.email})]}),(0,d.jsxs)("li",{className:"d-flex justify-content-between",children:[(0,d.jsx)("span",{className:"fw-bold fs-6",children:"Phone"}),(0,d.jsx)("span",{children:null===u||void 0===u?void 0:u.phone})]}),(0,d.jsxs)("li",{className:"d-flex justify-content-between",children:[(0,d.jsx)("span",{className:"fw-bold fs-6",children:"Username"}),(0,d.jsx)("span",{children:null===u||void 0===u?void 0:u.username})]})]})})})]})})})})]})})]})},y=()=>(0,d.jsxs)("div",{children:[" ",(0,d.jsx)("div",{id:"audio_call",class:"modal fade",tabIndex:"-1",role:"dialog","aria-hidden":"true",children:(0,d.jsx)("div",{class:"modal-dialog modal-dialog-centered modal-xl chatapp-call-window",role:"document",children:(0,d.jsxs)("div",{class:"modal-content",children:[(0,d.jsxs)("div",{class:"modal-header header-wth-bg",children:[(0,d.jsx)("h6",{class:"modal-title text-muted",children:"Jampack Audio Call"}),(0,d.jsxs)("div",{class:"modal-action",children:[(0,d.jsx)("a",{href:"/",class:"btn btn-xs btn-icon btn-flush-dark btn-rounded flush-soft-hover modal-fullscreen-togglable",children:(0,d.jsxs)("span",{class:"icon",children:[(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)("i",{"data-feather":"maximize"})}),(0,d.jsx)("span",{class:"feather-icon d-none",children:(0,d.jsx)("i",{"data-feather":"minimize"})})]})}),(0,d.jsx)("a",{href:"/",class:"btn btn-xs btn-icon btn-flush-dark btn-rounded flush-soft-hover",children:(0,d.jsx)("span",{class:"icon",children:(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)("i",{"data-feather":"help-circle"})})})})]})]}),(0,d.jsxs)("div",{class:"modal-body",children:[(0,d.jsx)("div",{class:"avatar avatar-xxxl avatar-rounded d-20",children:(0,d.jsx)("img",{src:"dist/img/avatar8.jpg",alt:"user",class:"avatar-img"})}),(0,d.jsx)("h3",{class:"mt-3",children:"Huma Therman"}),(0,d.jsxs)("p",{children:["Audio Calling",(0,d.jsx)("span",{class:"one",children:"."}),(0,d.jsx)("span",{class:"two",children:"."}),(0,d.jsx)("span",{class:"three",children:"."})]})]}),(0,d.jsxs)("div",{class:"modal-footer",children:[(0,d.jsxs)("ul",{class:"chatapp-call-action hk-list",children:[(0,d.jsx)("li",{children:(0,d.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-soft-light",children:(0,d.jsx)("span",{class:"icon",children:(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)("i",{"data-feather":"mic"})})})})}),(0,d.jsx)("li",{children:(0,d.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-soft-light",children:(0,d.jsx)("span",{class:"icon",children:(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)("i",{"data-feather":"video"})})})})}),(0,d.jsx)("li",{children:(0,d.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-danger","data-bs-dismiss":"modal",children:(0,d.jsx)("span",{class:"icon",children:(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)("i",{"data-feather":"phone"})})})})}),(0,d.jsx)("li",{children:(0,d.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-soft-light",children:(0,d.jsx)("span",{class:"icon",children:(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)("i",{"data-feather":"user-plus"})})})})}),(0,d.jsx)("li",{children:(0,d.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-soft-light",children:(0,d.jsx)("span",{class:"icon",children:(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)("i",{"data-feather":"more-vertical"})})})})})]}),(0,d.jsx)("div",{class:"avatar avatar-lg avatar-rounded chatapp-caller-img",children:(0,d.jsx)("img",{src:"dist/img/avatar13.jpg",alt:"user",class:"avatar-img"})})]})]})})})]});var w=a(54316);const k=a.p+"static/media/ringtone.4c48bc10148b84f015c9.mp3",C=a.p+"static/media/ringing.741f989dc753e84b2812.mp3",R=()=>{const[e,s]=(0,i.useState)({mins:0,sec:0});return(0,i.useEffect)((()=>{const e=setInterval((()=>{s((e=>({mins:60===e.sec?e.mins+1:e.mins,sec:60===e.sec?0:e.sec+1})))}),1e3);return()=>clearInterval(e)}),[]),(0,d.jsx)("div",{className:"timer",children:"".concat(e.mins<9?"0"+e.mins:e.mins," : ").concat(e.sec<9?"0"+e.sec:e.sec)})},E=e=>{let{selectedRoom:s,authUser:a,socket:n}=e;const{isCalling:l,callAccepted:o,myVideo:r,call:u,answerCall:h,ringing:v,userVideo:m,callEnded:x,leaveCall:f,openCalling:g,callUser:b,type:_}=(0,i.useContext)(p.J),y=(0,i.useRef)(null),E=(0,i.useRef)(null),[N,S]=(0,i.useState)(null),[U,A]=(0,i.useState)(null),{users:I}=(0,t.v9)((e=>e.user)),{token:T}=(0,t.v9)((e=>e.auth)),[D,L]=(0,i.useState)(!1),M=(0,t.I0)(),z=(0,i.useCallback)((()=>{l||null!==u&&void 0!==u&&u.isRecieving||!g||b(null===N||void 0===N?void 0:N.socket_id,a.name,_,null===N||void 0===N?void 0:N.name)}),[b,N,a,l,u,g,_]);(0,i.useMemo)((()=>{z()}),[z]),(0,i.useEffect)((()=>{(null===I||void 0===I?void 0:I.length)>0&&A(I)}),[I]),(0,i.useEffect)((()=>{T&&M((0,j.Rf)(T))}),[T,M]),(0,i.useEffect)((()=>{const e=s.user_id_1===a.id?s.user_id_2:s.user_id_1;if((null===U||void 0===U?void 0:U.length)>0){const s=null===U||void 0===U?void 0:U.filter((s=>s.id===e));S(s[0])}}),[U,a,s]),(0,i.useMemo)((()=>{var e;!0===(null===u||void 0===u?void 0:u.isReceivingCall)&&v&&(null===u||void 0===u?void 0:u.userToCall)===a.socket_id&&!o?y.current.play():null===y||void 0===y||null===(e=y.current)||void 0===e||e.pause()}),[u,v,o,a]),(0,i.useMemo)((()=>{var e;g&&!o?E.current.play():null===E||void 0===E||null===(e=E.current)||void 0===e||e.pause()}),[E,g,o]);const B=()=>{L(!1)};return(0,d.jsxs)("div",{children:[(0,d.jsx)("audio",{ref:y,onEnded:B,src:k}),(0,d.jsx)("audio",{ref:E,onEnded:B,src:C}),(0,d.jsx)("div",{id:"video_call",class:"modal",tabIndex:"-1",role:"dialog",togg:"modal","aria-hidden":"true",children:(0,d.jsx)("div",{class:"modal-dialog modal-dialog-centered modal-xl chatapp-call-window",role:"document",children:(0,d.jsxs)("div",{class:"modal-content ".concat("video"===_?"bg-primary-dark-5":"bg-light"," "),children:[(0,d.jsxs)("div",{class:"modal-header header-wth-bg bg-primary-dark-3",children:[(0,d.jsxs)("h6",{class:"modal-title",style:{color:"white"},children:["video"===_?"Video":"Audio"," Call"]}),(0,d.jsx)("div",{class:"modal-action",children:(0,d.jsx)("a",{href:"/",class:"btn btn-xs btn-icon btn-rounded btn-link link-secondary modal-fullscreen-togglable",children:(0,d.jsxs)("span",{class:"icon",children:[(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)(w.hCT,{})}),(0,d.jsx)("span",{class:"feather-icon d-none",children:(0,d.jsx)(w.Jm4,{})})]})})})]}),(0,d.jsx)("div",{class:"text-center m-auto",children:"audio"===_&&(0,d.jsx)("div",{class:"avatar avatar-xxxl avatar-rounded d-20 ",style:{marginTop:"10%"},children:(0,d.jsx)("img",{src:(s.user_id_1===(null===a||void 0===a?void 0:a.id)?s.user_image_2:s.user_image_1)||"https://static-00.iconduck.com/assets.00/profile-default-icon-1024x1023-4u5mrj2v.png",alt:"user",className:"avatar-img m-auto"})})}),o&&!x&&(0,d.jsx)("video",{playsInline:!0,ref:m,autoPlay:!0,style:{},className:"video-container"}),(0,d.jsxs)("div",{class:"modal-footer position-absolute bottom-0 w-100",children:[(0,d.jsxs)("div",{className:"d-flex justify-content-center w-100",children:[(0,d.jsx)("ul",{class:"chatapp-call-action hk-list",children:!0===(null===u||void 0===u?void 0:u.isReceivingCall)&&v&&(null===u||void 0===u?void 0:u.userToCall)===a.socket_id&&!o?(0,d.jsx)("li",{children:(0,d.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-success",onClick:h,children:(0,d.jsx)("span",{class:"icon",children:(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)(c.I7T,{})})})})}):(0,d.jsx)("li",{children:(0,d.jsx)("button",{class:"btn btn-icon btn-lg btn-rounded btn-danger","data-bs-dismiss":"modal",onClick:()=>f(N.socket_id),children:(0,d.jsx)("span",{class:"icon",children:(0,d.jsx)("span",{class:"feather-icon",children:(0,d.jsx)(c.I7T,{})})})})})}),(0,d.jsxs)("div",{class:"avatar avatar-lg avatar-rounded chatapp-caller-img ",children:[(0,d.jsx)("video",{playsInline:!0,muted:!0,ref:r,autoPlay:!0,width:"140",height:"150"}),"audio"===_&&(0,d.jsx)("img",{src:(s.user_id_1===(null===a||void 0===a?void 0:a.id)?s.user_image_1:s.user_image_2)||"https://static-00.iconduck.com/assets.00/profile-default-icon-1024x1023-4u5mrj2v.png",alt:"user",className:"avatar-img"})]})]}),(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("h3",{className:"mt-3",style:{color:"audio"===_?"black":"white"},children:(null===N||void 0===N?void 0:N.name)||(null===u||void 0===u?void 0:u.name)}),o?(0,d.jsx)(R,{}):(0,d.jsxs)("p",{style:{color:"audio"===_?"black":"white"},children:["audio"===_?"Audio":"Video"," Calling",(0,d.jsx)("span",{class:"one",children:"."}),(0,d.jsx)("span",{class:"two",children:"."}),(0,d.jsx)("span",{class:"three",children:"."})]})]})]})]})})})]})},N=e=>{let{users:s,authUser:a,socket:n}=e;const[t,l]=(0,i.useState)([]);return(0,d.jsx)("div",{children:(0,d.jsx)("div",{class:"modal fade",id:"invite_people",tabindex:"-1",role:"dialog",children:(0,d.jsx)("div",{class:"modal-dialog modal-dialog-centered mw-400p",role:"document",children:(0,d.jsxs)("div",{class:"modal-content",children:[(0,d.jsxs)("div",{class:"modal-header header-wth-bg-inv",children:[(0,d.jsx)("h5",{class:"modal-title",children:"Invite"}),(0,d.jsx)("button",{type:"button",class:"btn-close text-white","data-bs-dismiss":"modal","aria-label":"Close",children:(0,d.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,d.jsxs)("div",{class:"modal-body p-0",children:[(0,d.jsx)("form",{class:"m-3",role:"search",children:(0,d.jsx)("input",{type:"text",class:"form-control rounded-input user-search",placeholder:"Search People"})}),(0,d.jsx)("div",{class:"h-350p",children:(0,d.jsx)("div",{"data-simplebar":!0,class:"nicescroll-bar",children:(0,d.jsx)("ul",{class:"invite-user-list",children:(null===s||void 0===s?void 0:s.length)>0?null===s||void 0===s?void 0:s.map(((e,s)=>(0,d.jsxs)("li",{children:[(0,d.jsxs)("div",{class:"media d-flex align-items-center",children:[(0,d.jsx)("div",{class:"media-head me-3",children:(0,d.jsx)("div",{class:"avatar avatar-sm avatar-rounded",children:(0,d.jsx)("img",{src:e.avatar||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg",alt:"user",class:"avatar-img"})})}),(0,d.jsx)("div",{class:"media-body",children:(0,d.jsx)("div",{class:"user-name",children:e.name})})]}),(0,d.jsx)("div",{children:(0,d.jsx)("input",{type:"checkbox",class:"form-check-input",checked:t[e.id]||!1,onChange:()=>{return s=e.id,void l((e=>({...e,[s]:!e[s]})));var s}})})]},s))):(0,d.jsx)("li",{children:"No users found."})})})})]}),(0,d.jsxs)("div",{class:"modal-footer justify-content-center",children:[(0,d.jsx)("button",{type:"button",class:"btn flex-fill btn-light flex-1","data-bs-dismiss":"modal",children:"Cancel"}),(0,d.jsx)("button",{onClick:()=>{Object.entries(t).map((e=>{let[i,t]=e;if(t){var l,d,o,c;const e=null===s||void 0===s?void 0:s.filter((e=>e.id===h().toInteger(i))),t=(r=null===a||void 0===a?void 0:a.id,u=null===(l=e[0])||void 0===l?void 0:l.id,"".concat(Math.min(r,u),"_").concat(Math.max(r,u))),v={user_id_1:null===a||void 0===a?void 0:a.id,user_id_2:null===(d=e[0])||void 0===d?void 0:d.id,user_name_1:null===a||void 0===a?void 0:a.name,user_name_2:null===(o=e[0])||void 0===o?void 0:o.name,user_image_1:null===a||void 0===a?void 0:a.avatar,user_image_2:null===(c=e[0])||void 0===c?void 0:c.avatar,name:t};n.emit("add-chat-room",v)}var r,u}))},type:"button",class:"btn flex-fill btn-primary flex-1","data-bs-dismiss":"modal",children:"Invite for chat"})]})]})})})})};var S=a(91608),U=a(75985);const A=()=>{const e="".concat("https://desktopcrm.com:51/v1"),s="https://desktopcrm.com:51",a=(0,i.useMemo)((()=>(0,S.ZP)(s)),[s]),[n,l]=(0,i.useState)({}),[o,c]=(0,i.useState)([]),[u,v]=(0,i.useState)([]),[m,x]=(0,i.useState)([]),{user:p,token:f}=(0,t.v9)((e=>e.auth)),{users:g}=(0,t.v9)((e=>e.user)),[w,k]=(0,i.useState)([]),[C,R]=(0,i.useState)([]),[A,I]=(0,i.useState)(!1),T=(0,t.I0)(),D=(0,i.useCallback)((async()=>{I(!0);try{const s={headers:{"Content-Type":"application/json","x-access-token":f}};await b.Z.get("".concat(e,"/user/chat/get-rooms"),s).then((e=>{var s,a,i;R(e.data.data.chatRoomsData);const n=null===e||void 0===e||null===(s=e.data)||void 0===s||null===(a=s.data)||void 0===a||null===(i=a.chatRoomsData)||void 0===i?void 0:i.filter((e=>"blocked"!==e.status&&"archived"!==e.status));k(n),I(!1)}))}catch(s){U.Am.error(s.message),I(!1)}}),[e,f]),L=(0,i.useCallback)((async s=>{try{const a={headers:{"Content-Type":"application/json","x-access-token":f}};await b.Z.delete("".concat(e,"/user/chat/delete-group-chat-history/").concat(s),a).then((e=>{D()}))}catch(a){U.Am.error(a.message)}}),[e,f,D]),M=(0,i.useCallback)((async(s,a)=>{try{const i={headers:{"Content-Type":"application/json","x-access-token":f}};await b.Z.put("".concat(e,"/user/chat/update-chat/").concat(s),a,i).then((e=>{D()}))}catch(i){U.Am.error(i.message)}}),[e,f,D]),z=(0,i.useCallback)((async s=>{try{const a={headers:{"Content-Type":"application/json","x-access-token":f}};await b.Z.get("".concat(e,"/user/chat/chat-history/").concat(null===s||void 0===s?void 0:s.user_id_1,"/").concat(null===s||void 0===s?void 0:s.user_id_2),a).then((e=>{var s;c(null===(s=e.data)||void 0===s?void 0:s.data.chatData)}))}catch(a){U.Am.error(a.message)}}),[e,f]);(0,i.useMemo)((()=>{n&&z(n)}),[z,n]);const B=(0,i.useCallback)((async s=>{try{const s={headers:{"Content-Type":"application/json","x-access-token":f}};await b.Z.get("".concat(e,"/user/chat/get-chats"),s).then((e=>{var s;v(null===(s=e.data)||void 0===s?void 0:s.data.chatData)}))}catch(a){U.Am.error(a.message)}}),[e,f]);(0,i.useMemo)((()=>{n&&z(n)}),[z,n]),(0,i.useEffect)((()=>{f&&(D(),B(),T((0,j.Rf)(f)))}),[f,T,D,B]),(0,i.useEffect)((()=>{a.on("message_added",(e=>{c(e)})),a.on("room_added",(e=>{k(e)}))}),[a]),(0,i.useEffect)((()=>{if((null===g||void 0===g?void 0:g.length)>0){const e=null===g||void 0===g?void 0:g.filter((e=>h().toInteger(e.parent_id)===p.id||h().toInteger(e.client_id)===p.id));x(e)}}),[g,p]);return(0,d.jsx)("div",{children:(0,d.jsx)("div",{class:"hk-pg-wrapper pb-0",children:(0,d.jsx)("div",{class:"hk-pg-body py-0",children:(0,d.jsx)("div",{class:"chatapp-wrap chatapp-info-active",children:(0,d.jsxs)("div",{class:"chatapp-content",children:[(0,d.jsx)(r,{socket:a,rooms:w,roomsLoading:A,rooms_:C,onFilterDataFromChild:e=>{k(e)},authUser:p,onDataFromChild:e=>{l(e)},messages:u,deleteChatRecord:L,updateChat:M}),(null===n||void 0===n?void 0:n.id)&&(0,d.jsx)(_,{messages:o,selectedRoom:n,authUser:p,socket:a}),(0,d.jsx)(y,{socket:a,authUser:p,selectedRoom:n}),(0,d.jsx)(E,{socket:a,authUser:p,selectedRoom:n}),(0,d.jsx)(N,{users:m,authUser:p,socket:a})]})})})})})},I=()=>(0,d.jsx)("div",{children:(0,d.jsx)(n.Z,{component:(0,d.jsx)(A,{})})})},64802:function(e,s,a){var i,n,t;n=[],void 0===(t="function"===typeof(i=function(){"use strict";function s(e,s){return"undefined"==typeof s?s={autoBom:!1}:"object"!=typeof s&&(console.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function i(e,s,a){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){o(i.response,s,a)},i.onerror=function(){console.error("could not download file")},i.send()}function n(e){var s=new XMLHttpRequest;s.open("HEAD",e,!1);try{s.send()}catch(e){}return 200<=s.status&&299>=s.status}function t(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(i){var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(s)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a.g&&a.g.global===a.g?a.g:void 0,d=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=l.saveAs||("object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!d?function(e,s,a){var d=l.URL||l.webkitURL,o=document.createElement("a");s=s||e.name||"download",o.download=s,o.rel="noopener","string"==typeof e?(o.href=e,o.origin===location.origin?t(o):n(o.href)?i(e,s,a):t(o,o.target="_blank")):(o.href=d.createObjectURL(e),setTimeout((function(){d.revokeObjectURL(o.href)}),4e4),setTimeout((function(){t(o)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,l){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(s(e,l),a);else if(n(e))i(e,a,l);else{var d=document.createElement("a");d.href=e,d.target="_blank",setTimeout((function(){t(d)}))}}:function(e,s,a,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return i(e,s,a);var t="application/octet-stream"===e.type,o=/constructor/i.test(l.HTMLElement)||l.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||t&&o||d)&&"undefined"!=typeof FileReader){var r=new FileReader;r.onloadend=function(){var e=r.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},r.readAsDataURL(e)}else{var u=l.URL||l.webkitURL,h=u.createObjectURL(e);n?n.location=h:location.href=h,n=null,setTimeout((function(){u.revokeObjectURL(h)}),4e4)}});l.saveAs=o.saveAs=o,e.exports=o})?i.apply(s,n):i)||(e.exports=t)}}]);
//# sourceMappingURL=1490.0fa5042e.chunk.js.map