(self.webpackChunkclient=self.webpackChunkclient||[]).push([[4282],{56874:(e,s,a)=>{"use strict";a.d(s,{A:()=>n});a(82483);var o=a(28846),t=a(56723);const n=function(e){let s,{fileType:a,fileUrl:n,fileWidth:i}=e;switch(a){case"jpeg":case"png":case"jpg":s=(0,t.jsx)("img",{className:"img-fluid rounded",style:{maxWidth:"300px"},src:n,width:i,alt:" preview"});break;case"pdf":s=(0,t.jsx)(o.kl1,{});break;case"zip":s=(0,t.jsx)(o.aw1,{});break;case"video":s=(0,t.jsxs)("video",{controls:!0,width:i,height:"auto",children:[(0,t.jsx)("source",{src:n,type:"video/mp4"}),"Your browser does not support the video tag."]});break;default:s=(0,t.jsx)(o.FrV,{color:"white",size:70,n:!0})}return(0,t.jsx)("div",{className:"",children:s})}},57557:(e,s,a)=>{"use strict";a.d(s,{A:()=>c});var o=a(82483),t=a(23080),n=a(34304),i=a.n(n),l=a(25184),d=a(56723);const r=o.forwardRef(((e,s)=>{const{field:a}=(0,t.as)(e),[n,r]=(0,o.useState)(!1),[c,u]=(0,o.useState)(""),h=(0,o.useRef)(null),{title:v,style:m,isHighLight:p=!1,type:f,errors:x,defaultValue:g,customStyle:j,onChange:b,ellipses:y,label:k,...w}=e;let _=i().get(x,e.name);return(0,o.useEffect)((()=>{f&&""!==f&&u(f)}),[f]),(0,d.jsxs)("div",{className:"w-full mb-5",children:[(0,d.jsxs)("div",{className:"".concat(m?"bg-white":"","  ").concat(null!==e&&void 0!==e&&e.rules&&_?"focus-within:border-red-600 border-red-600":"focus-within:border-teal-c-900"),children:[(0,d.jsx)(t.xI,{name:null===e||void 0===e?void 0:e.name,control:null===e||void 0===e?void 0:e.control,rules:null===e||void 0===e?void 0:e.rules,className:"form-group",defaultValue:""!==g?g:"",render:s=>{let{field:a}=s;return(0,d.jsxs)("div",{className:"",style:{height:"280px",overflow:"hidden"},children:[k&&(0,d.jsx)("label",{class:"form-label-group",children:k}),(0,d.jsx)(l.K,{...e,...w,apiKey:"tnm05u4rxvm3tav3sjqqew5pngxe7zeju5e2zfh392oi034c",onKeyUp:e=>{u(""),a.onChange(h.current.getContent())},onInit:(e,s)=>h.current=s,initialValue:"edit"===c&&a.value||"<p>Put your content here.</p>",init:{height:300,menubar:!1,plugins:["a11ychecker advcode casechange formatpainter","linkchecker autolink lists checklist","media mediaembed pageembed permanentpen","powerpaste table advtable tinymcespellchecker"],toolbar:"formatselect | fontselect | bold italic strikethrough   formatpainter | alignleft aligncenter alignright alignjustify | numlist bullist outdent indent | link insertfile image | removeformat | code | addcomment | checklist | casechange",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }, .tox-statusbar{display:none}"}})]})}}),(0,d.jsx)("div",{className:"pointer-events-none absolute ml-2 left-0 duration-300 origin-0 mr-2 inline-block px-1 font-normal  ".concat(null!==e&&void 0!==e&&e.rules&&_?"text-red-600":"text-gray-600","  ").concat(n||""===!a.value||"0"===a.value?"-top-2 duration-300 bg-[white] text-xs rounded-lg":"top-2 duration-300 text-base xl:top-1 ".concat(y&&"w-[98%] text-ellipsis overflow-hidden whitespace-nowrap")," \n            ").concat(p&&" bg-highLight  ","  \n            ")})]}),e.rules&&_&&(0,d.jsx)("p",{className:"text-xs p-1 text-danger",id:"email-error",children:e.rules&&_&&e.rules&&(null===_||void 0===_?void 0:_.message)})]})}));r.displayName="EditorField";const c=r},90374:(e,s,a)=>{"use strict";a.d(s,{IP:()=>d,M8:()=>u,Yj:()=>h,lm:()=>r,tQ:()=>c,xY:()=>l});var o=a(11222),t=a(31021),n=a(73422);const i="".concat("https://desktopcrm.com:51/v1"),l=(e,s,a,l)=>async d=>{try{d((0,t.kl)());const r={headers:{"Content-Type":"application/json","x-access-token":e}};await o.A.get("".concat(i,"/user/email/get-emails/").concat(s,"/").concat(a,"/").concat(l),r).then((e=>{var s;if(200!==(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.statusCode))return n.oR.error(e.data.message),d((0,t.xk)(e.data.message));d((0,t.cE)(e.data.data.emailsData))}))}catch(r){d((0,t.xk)(r.message))}},d=(e,s)=>async a=>{try{a((0,t.kl)());const l={headers:{"Content-Type":"application/json","x-access-token":e}};await o.A.post("".concat(i,"/user/email/get-emails-by-email"),s,l).then((e=>{var s;if(200!==(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.statusCode))return n.oR.error(e.data.message),a((0,t.xk)(e.data.message));a((0,t.cE)(e.data.data.emailsData))}))}catch(l){a((0,t.xk)(l.message))}},r=(e,s)=>async a=>{try{a((0,t.kl)());const l={headers:{"Content-Type":"multipart/form-data","x-access-token":e}};await o.A.post("".concat(i,"/user/email/send-email"),s,l).then((e=>{var s;if(200!==(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.statusCode))return n.oR.error(e.data.message),a((0,t.xk)(e.data.message));a((0,t.ZM)(e.data.message)),n.oR.success(e.data.message)}))}catch(l){a((0,t.xk)(l.message))}},c=(e,s)=>async a=>{try{a((0,t.kl)());const l={headers:{"Content-Type":"multipart/form-data","x-access-token":e}};await o.A.post("".concat(i,"/user/email/send-email-bulk"),s,l).then((e=>{var s;if(console.log(e),200!==(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.statusCode))return n.oR.error(e.data.message),a((0,t.xk)(e.data.message));a((0,t.ZM)(e.data.message)),n.oR.success(e.data.message)}))}catch(l){a((0,t.xk)(l.message))}},u=(e,s,a)=>async d=>{try{d((0,t.kl)());const r={headers:{"Content-Type":"application/json","x-access-token":e}};await o.A.put("".concat(i,"/user/email/update-email/").concat(s),a,r).then((s=>{var o;if(200!==(null===s||void 0===s||null===(o=s.data)||void 0===o?void 0:o.statusCode))return n.oR.error(s.data.message),d((0,t.xk)(s.data.message));d((0,t.Ww)(s.data.message)),d(l(e,a.user_email,20,1)),n.oR.success(s.data.message)}))}catch(r){d((0,t.xk)(r.message))}},h=(e,s)=>async a=>{try{a((0,t.kl)());const d={headers:{"Content-Type":"application/json","x-access-token":e}};await o.A.delete("".concat(i,"/user/email/delete-email/").concat(s),d).then((s=>{var o;if(200!==(null===s||void 0===s||null===(o=s.data)||void 0===o?void 0:o.statusCode))return n.oR.error(s.data.message),a((0,t.xk)(s.data.message));a((0,t.Ww)(s.data.message)),a(l(e)),n.oR.success(s.data.message)}))}catch(d){a((0,t.xk)(d.message))}}},39161:(e,s,a)=>{"use strict";a.d(s,{I:()=>d,L:()=>l});var o=a(11222),t=a(9910),n=a(73422);const i="".concat("https://desktopcrm.com:51/v1"),l=e=>async s=>{try{s((0,t.hb)());const a={headers:{"Content-Type":"application/json","x-access-token":e}};await o.A.get("".concat(i,"/user/calling/user-messages"),a).then((e=>{var a;if(console.log("\ud83d\ude80 ~ .then ~ response:",e),200!==(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.statusCode))return n.oR.error(e.data.message),s((0,t.xk)(e.data.message));s((0,t.ez)(e.data.data.messagesData))}))}catch(a){s((0,t.xk)(a.message))}},d=(e,s)=>async a=>{try{a((0,t.hb)());const l={headers:{"Content-Type":"application/json","x-access-token":e}};await o.A.post("".concat(i,"/user/calling/user-messages-logs"),s,l).then((e=>{var s;if(console.log("\ud83d\ude80 ~ .then ~ response:",e),200!==(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.statusCode))return n.oR.error(e.data.message),a((0,t.xk)(e.data.message));a((0,t.ez)(e.data.data.messagesData))}))}catch(l){a((0,t.xk)(l.message))}}},96099:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>F});var o=a(82483),t=a(16575),n=a(28846),i=a(56723);const l=e=>{let{rooms:s,authUser:a,onDataFromChild:t,messages:l,onMessagesDataFromChild:d,a2pVerified:r}=e;const[c,u]=(0,o.useState)(""),[h,v]=(0,o.useState)([]),[m,p]=(0,o.useState)([]);(0,o.useEffect)((()=>{p(s),v(s)}),[s]);function f(e){const s=new Date(e),a=new Date,o=new Date(a);if(o.setDate(a.getDate()-1),s.toDateString()===a.toDateString())return"Today";if(s.toDateString()===o.toDateString())return"Yesterday";{const e={year:"numeric",month:"long",day:"numeric"};return s.toLocaleDateString("en-US",e)}}return(0,i.jsxs)("div",{children:[(0,i.jsx)("form",{class:"aside-search",role:"search",children:(0,i.jsx)("input",{type:"text",class:"form-control",placeholder:"Search Chats",onKeyUp:e=>{if(console.log(e.target.value),""!==e.target.value||void 0!==e.target.value){const s=(null===h||void 0===h?void 0:h.length)>0&&(null===h||void 0===h?void 0:h.filter((s=>{var a,o;return(null===s||void 0===s||null===(a=s.to_phone)||void 0===a?void 0:a.includes(e.target.value))||(null===s||void 0===s||null===(o=s.to_name)||void 0===o?void 0:o.includes(e.target.value))})));p(s)}else p(h)}})})," ",(0,i.jsx)("ul",{class:"chat-contacts-list list-group list-group-flush",children:(null===m||void 0===m?void 0:m.length)>0?null===m||void 0===m?void 0:m.map(((e,s)=>{const o=(null===m||void 0===m?void 0:m.length)>0&&(null===m||void 0===m?void 0:m.filter((s=>s.from_phone===a.phone&&s.to_phone===e.to_phone&&s.user_id===a.id||s.to_phone===a.phone&&s.from_phone===e.from_phone&&"inbound"===(null===s||void 0===s?void 0:s.direction)))),r=o[o.length-1];return(0,i.jsx)("li",{class:"list-group-item",onClick:()=>(e=>{u(e),t(e);const s=(null===l||void 0===l?void 0:l.length)>0&&(null===l||void 0===l?void 0:l.filter((s=>s.from_phone===a.phone&&s.to_phone===e.to_phone&&s.user_id===a.id||s.to_phone===a.phone&&s.from_phone===e.from_phone&&"inbound"===(null===s||void 0===s?void 0:s.direction))));d(s)})(e),children:(0,i.jsxs)("div",{class:"media",children:[(0,i.jsx)("div",{class:"media-head",children:(0,i.jsx)("div",{class:"avatar avatar-sm avatar-primary position-relative avatar-rounded",children:(0,i.jsx)("span",{class:"initial-wrap",children:(0,i.jsx)(n.K9B,{})})})}),(0,i.jsxs)("div",{class:"media-body",children:[(0,i.jsx)("div",{children:(0,i.jsx)("div",{class:"user-name",children:"outbound"===(null===e||void 0===e?void 0:e.direction)?null===e||void 0===e?void 0:e.to_phone:null===e||void 0===e?void 0:e.from_phone})}),(0,i.jsx)("div",{children:(0,i.jsx)("div",{class:"last-chat-time",children:null!==r&&void 0!==r&&r.created_at?f((null===r||void 0===r?void 0:r.created_at)||new Date):"..."})})]})]})},s)})):(0,i.jsx)("li",{children:"No rooms till."})})]})};var d=a(49640);const r=e=>{let{rooms:s,authUser:a,socket:o,onDataFromChild:t,messages:r,onMessagesDataFromChild:c,onShowAddForm:u,a2pVerified:h}=e;return(0,i.jsxs)("div",{children:[" ",(0,i.jsxs)("div",{class:"chatapp-aside",children:[(0,i.jsxs)("header",{class:"aside-header",children:[(0,i.jsxs)("h1",{className:"fs-5 fw-bold",children:[(0,i.jsx)("span",{className:"pe-2",children:(0,i.jsx)(n.maD,{size:30,color:"#007D88"})}),"SMS Marketting"]}),(0,i.jsx)("a",{href:"/",class:"btn btn-icon btn-rounded show-compose-popup btn-primary",onClick:()=>u(!0),children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)(d.gml,{})})})})]}),(0,i.jsxs)("div",{"data-simplebar":!0,class:"aside-body",children:[(0,i.jsx)("div",{className:"alert alert-warning",children:h?(0,i.jsx)(i.Fragment,{}):(0,i.jsxs)("p",{children:["A2P Verfification is required for conversation in US/Canada.\xa0",(0,i.jsx)("a",{href:"#","data-bs-target":"#a2p-modal","data-bs-toggle":"modal",className:"text-underline",children:(0,i.jsx)("ins",{children:"Add Details"})})]})}),(0,i.jsx)(l,{rooms:s,authUser:a,a2pVerified:h,socket:o,onDataFromChild:t,messages:r,onMessagesDataFromChild:c})]})]})]})};a(34304);var c=a(94690),u=a.n(c),h=a(28100),v=a.n(h),m=a(56874),p=a(99492),f=a(91965),x=a(49678),g=a(22598),j=(a(53572),a(55870)),b=a(73422);const y=e=>{let{messages:s,selectedRoom:a,authUser:t,socket:l,selectedMessages:d,a2pVerified:r}=e;const{sendTextMessage:c}=(0,o.useContext)(p.d),[h,y]=(0,o.useState)(null),[k,w]=(0,o.useState)(null),{users:_}=(0,f.d4)((e=>e.user)),{balanceDetails:C}=(0,f.d4)((e=>e.balance)),{token:S,user:A}=(0,f.d4)((e=>e.auth)),N=(0,f.wA)();(0,o.useEffect)((()=>{(null===d||void 0===d?void 0:d.length)>0&&document.getElementById("dummy_avatar").scrollIntoView({behavior:"smooth",block:"end"})}),[d]),(0,o.useEffect)((()=>{(null===_||void 0===_?void 0:_.length)>0&&w(_)}),[_]),(0,o.useEffect)((()=>{S&&N((0,x.lo)(S))}),[S,N]),(0,o.useEffect)((()=>{const e=a.user_id_1===t.id?a.user_id_2:a.user_id_1;if((null===k||void 0===k?void 0:k.length)>0){const s=null===k||void 0===k?void 0:k.filter((s=>s.id===e));y(s[0])}}),[k,t,a]);const[E,D]=(0,o.useState)(null),[T,R]=(0,o.useState)([]),[F,U]=(0,o.useState)(),V=e=>{if(null!==(null===A||void 0===A?void 0:A.phone)&&void 0!==(null===A||void 0===A?void 0:A.phone)&&""!==(null===A||void 0===A?void 0:A.phone))if(parseInt(null===C||void 0===C?void 0:C.credit)>0)if(null!==F){if("Enter"===e.key||"click"===e.type){const e={from:{phone:t.phone,name:t.name,avatar:t.avatar,socket_id:t.socket_id,accountSid:null===t||void 0===t?void 0:t.accountSid,authToken:null===t||void 0===t?void 0:t.authToken},to:{phone:null===a||void 0===a?void 0:a.to_phone,name:(null===a||void 0===a?void 0:a.firstname)+(null===a||void 0===a?void 0:a.lastname),avatar:null===a||void 0===a?void 0:a.avatar},message:F};null!==a&&void 0!==a&&a.includes("+1")&&!r?b.oR.warn("A2P verification is required for conversation in US/Canada."):c(e),U(null)}}else b.oR.error("Please write something in the message.");else b.oR.error("You have insufficient balance to send the message.");else b.oR.error("Please configure you number first, then you are able to send a message.")};(0,o.useEffect)((()=>{document.getElementById("dummy_avatar").scrollIntoView({behavior:"smooth",block:"end"}),v().config.update({accessKeyId:"AKIAX2CISY6LNJB3XTIK",secretAccessKey:"zA+9Ypk4sNqNl9HlY2zmBoEI4edXTEonDUwE2ZAU",region:"eu-west-2"});const e=new(v().S3);(async()=>{const s={Bucket:"jampackcrm"};try{const a=await e.listObjectsV2(s).promise();R(a.Contents)}catch(a){console.error("Error fetching objects:",a)}})()}),[]);const z=async(e,s)=>{const a=new(v().S3),o={Bucket:e,Key:s};try{const e=await a.getObject(o).promise(),t=URL.createObjectURL(new Blob([e.Body])),n=document.createElement("a");n.href=t,n.setAttribute("download",s),document.body.appendChild(n),n.click(),document.body.removeChild(n)}catch(t){console.error("Error downloading file:",t)}},I=e=>null===T||void 0===T?void 0:T.filter((s=>s.Key===e));function M(e){return null===e||void 0===e?void 0:e.split(".").pop().toLowerCase()}function B(e){const s=null===e||void 0===e?void 0:e.charAt(0),a=null===e||void 0===e?void 0:e.indexOf(" ");return{firstCharacter:s,characterAfterSpace:-1!==a?e.charAt(a+1):""}}return(0,i.jsxs)("div",{class:"chatapp-single-chat",children:[(0,i.jsxs)("header",{class:"chat-header",children:[(0,i.jsx)("a",{id:"back_user_list",class:"btn btn-sm btn-icon btn-flush-dark btn-rounded flush-soft-hover back-user-list",href:"/",children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)("i",{"data-feather":"chevron-left"})})})}),(0,i.jsxs)("div",{class:"media",children:[(0,i.jsx)("div",{class:"media-head",children:(0,i.jsx)("div",{class:"avatar avatar-sm avatar-primary position-relative avatar-rounded",children:(0,i.jsx)("span",{class:"initial-wrap",children:(0,i.jsx)(n.K9B,{})})})}),(0,i.jsx)("div",{class:"media-body",children:(0,i.jsxs)("div",{class:"user-name",children:[" ","outbound"===(null===a||void 0===a?void 0:a.direction)?null===a||void 0===a?void 0:a.to_phone:null===a||void 0===a?void 0:a.from_phone]})})]})]}),(0,i.jsx)("div",{"data-simplebar":!0,id:"chat_body",class:"chat-body",children:(0,i.jsx)("ul",{id:"dummy_avatar",class:"list-unstyled chat-single-list",children:(null===d||void 0===d?void 0:d.length)>0?d.map(((e,s)=>(null===e||void 0===e?void 0:e.from_phone)!==(null===t||void 0===t?void 0:t.phone)?(0,i.jsxs)("li",{class:"media received",children:[(0,i.jsx)("div",{class:"avatar avatar-sm avatar-primary position-relative avatar-rounded",children:(0,i.jsx)("span",{class:"initial-wrap",children:B(a.firstname+" "+a.lastname).firstCharacter+B(a.firstname+" "+a.lastname).characterAfterSpace})}),(0,i.jsx)("div",{class:"media-body",children:(0,i.jsxs)("div",{class:"msg-box",children:[(0,i.jsxs)("div",{children:[(null===e||void 0===e?void 0:e.file_key)&&(0,i.jsx)("button",{style:{border:"none",background:"none"},onClick:()=>{var s;return z("jampackcrm",null===(s=I(e.file_key)[0])||void 0===s?void 0:s.Key)},children:(0,i.jsx)(m.A,{fileType:M(null===e||void 0===e?void 0:e.file_key),fileUrl:"https://s3.eu-west-2.amazonaws.com/jampackcrm/".concat(null===e||void 0===e?void 0:e.file_key)})}),(0,i.jsx)("p",{children:e.message}),(0,i.jsxs)("span",{class:"chat-time",children:[u()(null===F||void 0===F?void 0:F.created_at).format("h:mm A"),(0,i.jsxs)("span",{className:"float-end",children:[" ",(null===e||void 0===e?void 0:e.file_key)&&((null===e||void 0===e?void 0:e.file_size)/1048576).toFixed(2)+" mb"]})]})]}),(0,i.jsxs)("div",{class:"msg-action",children:[(0,i.jsx)("a",{href:"/",class:"btn btn-icon btn-flush-dark btn-rounded flush-soft-hover no-caret",children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)("i",{"data-feather":"corner-up-right"})})})}),(0,i.jsx)("a",{href:"/",class:"btn btn-icon btn-flush-dark btn-rounded flush-soft-hover dropdown-toggle no-caret","data-bs-toggle":"dropdown",children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)("i",{"data-feather":"more-horizontal"})})})}),(0,i.jsxs)("div",{class:"dropdown-menu dropdown-menu-end",children:[(0,i.jsx)("a",{class:"dropdown-item",href:"/",children:"Forward"}),(0,i.jsx)("a",{class:"dropdown-item",href:"/",children:"Copy"})]})]})]})})]},s):(0,i.jsx)("li",{class:"media sent d-flex",children:(0,i.jsx)("div",{class:"media-body",style:{display:"flex"},children:(0,i.jsxs)("div",{className:"d-flex",children:[(0,i.jsx)("div",{class:"msg-box",children:(0,i.jsxs)("div",{children:[(null===e||void 0===e?void 0:e.file_key)&&(0,i.jsx)("button",{style:{border:"none",background:"none"},onClick:()=>{var s;return z("jampackcrm",null===(s=I(e.file_key)[0])||void 0===s?void 0:s.Key)},children:(0,i.jsx)(m.A,{fileType:M(null===e||void 0===e?void 0:e.file_key),fileUrl:"https://s3.eu-west-2.amazonaws.com/jampackcrm/".concat(null===e||void 0===e?void 0:e.file_key)})}),(0,i.jsx)("p",{children:e.message}),(0,i.jsxs)("span",{class:"chat-time",children:[u()(null===F||void 0===F?void 0:F.created_at).format("h:mm A"),(0,i.jsxs)("span",{className:"float-end",children:[" ",(null===e||void 0===e?void 0:e.file_key)&&((null===e||void 0===e?void 0:e.file_size)/1048576).toFixed(2)+" mb"]})]})]})}),(0,i.jsx)("div",{className:"",children:null===(null===e||void 0===e?void 0:e.sid)&&(0,i.jsx)("div",{class:"media-head",children:(0,i.jsx)("div",{class:"avatar avatar-sm avatar-secondary position-relative avatar-rounded",children:(0,i.jsx)(j.A,{trigger:(0,i.jsx)("button",{className:"btn btn-icon btn-floating btn-secondary btn-lg btn-rounded shadow-lg",id:"dialer_button",children:(0,i.jsx)(g.eHT,{color:"red",size:"24",style:{marginTop:"-15%"}})}),position:"bottom right",children:(0,i.jsx)("p",{className:"",children:null===e||void 0===e?void 0:e.message_error})})})})})]})})},s))):(0,i.jsx)("li",{children:" No Messages"})})}),(0,i.jsxs)("footer",{class:"chat-footer d-flex gap-2",children:[(0,i.jsx)("div",{children:(0,i.jsx)("button",{className:"btn btn-secondary shadow rounded-circle  float-end",style:{width:"35px",height:"35px"},onClick:()=>document.getElementById("dummy_avatar").scrollIntoView({behavior:"smooth",block:"end"}),children:(0,i.jsx)(n.$TP,{style:{marginLeft:"-7px",marginBottom:"4px"}})})}),(0,i.jsx)("div",{class:"input-group",children:(0,i.jsxs)("span",{class:"input-affix-wrapper",children:[(0,i.jsx)("input",{type:"text",name:"send-msg",class:"input-msg-send form-control rounded-input",placeholder:"Type your message...",value:F,onChange:e=>U(e.target.value),onKeyUp:e=>"Enter"===e.key&&V(e)}),(0,i.jsx)("span",{class:"input-suffix",children:(0,i.jsx)("button",{class:"btn btn-icon btn-flush-primary btn-rounded btn-send",onClick:e=>V(e),children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)(n.QyA,{})})})})]})})]}),(0,i.jsx)("div",{class:"chat-info",children:(0,i.jsxs)("div",{"data-simplebar":!0,class:"nicescroll-bar",children:[(0,i.jsx)("button",{type:"button",class:"info-close btn-close",children:(0,i.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}),(0,i.jsxs)("div",{class:"text-center",children:[(0,i.jsx)("div",{class:"avatar avatar-xxl avatar-rounded",children:(0,i.jsx)("img",{src:((null===a||void 0===a?void 0:a.user_id_1)===(null===t||void 0===t?void 0:t.id)?null===a||void 0===a?void 0:a.user_image_2:null===a||void 0===a?void 0:a.user_image_1)||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg",alt:"user",class:"avatar-img"})}),(0,i.jsxs)("div",{class:"cp-name text-truncate mt-2",children:[" ",null===a||void 0===a?void 0:a.to_phone]}),(0,i.jsx)("p",{class:"text-truncate",children:"No phone calls Always busy"})]})]})})]})};var k=a(68335),w=a(7874),_=a(39161),C=a(23080),S=a(70779),A=a(41609),N=a(4671),E=(a(7817),a(25463)),D=(a(90374),a(57557),a(710));const T=e=>{let{onShowAddForm:s,a2pVerified:a}=e;const{sendTextMessage:t}=(0,o.useContext)(p.d),{handleSubmit:l,watch:d,control:r,setValue:c,reset:u,formState:{errors:h}}=(0,C.mN)(),v=d("body"),m=(0,f.wA)(),{token:g,user:j}=(0,f.d4)((e=>e.auth)),{balanceDetails:y}=(0,f.d4)((e=>e.balance)),[k,w]=(0,o.useState)(!1),[_,T]=(0,o.useState)([]);(0,o.useEffect)((()=>{m((0,x.lo)(g))}),[g,m]);return(0,i.jsx)("div",{class:"compose-email-popup",children:(0,i.jsxs)("div",{class:"d-flex flex-column",children:[(0,i.jsxs)("header",{class:"d-flex align-items-center justify-content-between",children:[(0,i.jsx)("h6",{class:"text-white mb-0",children:"Compose Bulk"}),(0,i.jsxs)("div",{class:"d-flex",children:[(0,i.jsx)("button",{id:"min_compose_popup",class:"btn btn-sm btn-icon btn-dark btn-rounded d-lg-block d-none",children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)(n.iu5,{})})})}),(0,i.jsx)("button",{id:"max_compose_popup",class:"btn btn-sm btn-icon btn-dark btn-rounded d-lg-block d-none",children:(0,i.jsxs)("span",{class:"icon",children:[(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)(N.bPN,{})}),(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)(A.SsO,{})})]})}),(0,i.jsx)("button",{id:"close_compose_popup",class:"btn btn-sm btn-icon btn-dark btn-rounded",onClick:()=>s(!1),children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)(S.j55,{})})})})]})]}),k?(0,i.jsx)(D.A,{}):(0,i.jsxs)("form",{onSubmit:l((async e=>{try{if(null!==(null===j||void 0===j?void 0:j.phone)&&void 0!==(null===j||void 0===j?void 0:j.phone)&&""!==(null===j||void 0===j?void 0:j.phone))if(parseInt(null===y||void 0===y?void 0:y.credit)>0)if(a){var s,o;if(w(!0),_.length>0)await Promise.all(_.map((async e=>{const s={from:{phone:j.phone,name:j.name,avatar:j.avatar,socket_id:j.socket_id,accountSid:null===j||void 0===j?void 0:j.accountSid,authToken:null===j||void 0===j?void 0:j.authToken},to:{phone:e},user_id:null===j||void 0===j?void 0:j.id,message:v};console.log(s),await t(s)})));else if((null===e||void 0===e||null===(s=e.to)||void 0===s||null===(o=s.split("\n"))||void 0===o?void 0:o.length)>0){var n;const s=null===e||void 0===e||null===(n=e.to)||void 0===n?void 0:n.split("\n");await Promise.all(s.map((async e=>{const s={from:{phone:j.phone,name:j.name,avatar:j.avatar,socket_id:j.socket_id,accountSid:null===j||void 0===j?void 0:j.accountSid,authToken:null===j||void 0===j?void 0:j.authToken},to:{phone:e},message:v,user_id:null===j||void 0===j?void 0:j.id};await t(s)})))}w(!1),b.oR.success("SMS are successfully added to pipeline.")}else b.oR.warn("A2P Verification is required to process this marketting.");else b.oR.error("You have insufficient balance to send message.");else b.oR.error("Please configure you number first, then you are able to send a message.")}catch(i){console.error("Error sending SMS messages:",i)}})),style:{maxHeight:"600px",overflow:"scroll",scrollBehavior:"smooth"},children:[(0,i.jsx)("div",{className:"w-100",children:(0,i.jsx)(E.A,{name:"to",height:"150px",placeholder:"Enter list of phone numbers in format +1234567890",rows:2,control:r,errors:h})}),(0,i.jsxs)("div",{className:"w-100 form-group",children:[(0,i.jsxs)("label",{className:"form-label",children:["Upload CSV including column ",(0,i.jsx)("strong",{children:"`Numbers`"})]}),(0,i.jsx)("input",{type:"file",className:"form-control",name:"toNumbers",onChange:e=>{const s=e.currentTarget.files[0],a=new FileReader;a.onload=function(e){const s=(e=>{const s={},a=e.split("\n"),o=a[0].split(",").map((e=>e.trim()));o.forEach((e=>{s[e]=[]}));for(let t=1;t<a.length;t++){const e=a[t].split(",");for(let a=0;a<o.length&&a<e.length;a++)s[o[a]].push(e[a].trim())}return null===s||void 0===s?void 0:s.Numbers})(e.target.result),a=s.join("\n");T(s),c("to",a)},a.readAsText(s)}})]}),(0,i.jsx)("div",{className:"w-100",children:(0,i.jsx)(E.A,{name:"body",placeholder:"Body text",control:r,rows:4,rules:{required:{value:!0,message:"Field required!"}},errors:h})}),(0,i.jsx)("div",{class:"modal-footer ",children:(0,i.jsx)("div",{className:"w-100",children:(0,i.jsx)("button",{class:"btn btn-primary float-end",type:"submit",children:"Send"})})})]})]})})},R=()=>{const e="https://desktopcrm.com:51",{messagesArray:s}=(0,o.useContext)(p.d),[a,t]=(0,o.useState)({}),[n,l]=(0,o.useState)(!1),{messages:d}=(0,f.d4)((e=>e.message)),c=(0,o.useMemo)((()=>(0,k.Ay)(e)),[e]),[u,h]=(0,o.useState)({}),[v,m]=(0,o.useState)([]),[x,g]=(0,o.useState)([]),{user:j,token:b}=(0,f.d4)((e=>e.auth)),[C,S]=(0,o.useState)([]),[A,N]=(0,o.useState)(!1),E=(0,f.wA)();(0,o.useEffect)((()=>{m(d)}),[d]),(0,o.useEffect)((()=>{E((0,w.EC)(b)),E((0,_.L)(b))}),[b,E]),(0,o.useEffect)((()=>{if((null===d||void 0===d?void 0:d.length)>0){let e={},s=[];null===d||void 0===d||d.forEach((a=>{e[a.to_phone]||a.to_phone===(null===j||void 0===j?void 0:j.phone)||a.user_id!==(null===j||void 0===j?void 0:j.id)||"outbound"!==a.direction||(e[a.to_phone]=!0,s.push(a)),e[a.from_phone]||a.from_phone===(null===j||void 0===j?void 0:j.phone)||"inbound"!==a.direction||(e[a.from_phone]=!0,s.push(a))})),g(s)}}),[d,j]),(0,o.useEffect)((()=>{if((null===s||void 0===s?void 0:s.length)>0){let e={},a=[];null===s||void 0===s||s.forEach((s=>{e[s.to_phone]||s.to_phone===(null===j||void 0===j?void 0:j.phone)||s.user_id!==(null===j||void 0===j?void 0:j.id)||(e[s.to_phone]=!0,a.push(s))})),g(a)}}),[s,j]),(0,o.useEffect)((()=>{if((null===s||void 0===s?void 0:s.length)>0){m(s);const e=(null===s||void 0===s?void 0:s.length)>0&&(null===s||void 0===s?void 0:s.filter((e=>e.from_phone===(null===j||void 0===j?void 0:j.phone)&&e.to_phone===(null===u||void 0===u?void 0:u.to_phone)&&e.user_id===(null===j||void 0===j?void 0:j.id)||e.to_phone===(null===j||void 0===j?void 0:j.phone)&&e.from_phone===(null===u||void 0===u?void 0:u.from_phone)&&e.user_id===(null===j||void 0===j?void 0:j.id))));t(e),console.log("\ud83d\ude80 ~ useEffect ~ messagesData:",e)}}),[s,u,j]);const D=e=>{l(e)};return(0,i.jsx)("div",{children:(0,i.jsx)("div",{class:"hk-pg-wrapper pb-0",children:(0,i.jsxs)("div",{class:"hk-pg-body py-0",style:{maxHeight:"100%",overflow:"hidden"},children:[(0,i.jsx)("div",{class:"chatapp-wrap chatapp-info-active",children:(0,i.jsxs)("div",{class:"chatapp-content",children:[(0,i.jsx)(r,{socket:c,rooms:x,a2pVerified:A,messages:v,onFilterDataFromChild:e=>{S(e)},authUser:j,onDataFromChild:e=>{h(e)},onMessagesDataFromChild:e=>{t(e)},onShowAddForm:D}),(null===u||void 0===u?void 0:u.id)&&(0,i.jsx)(y,{messages:v,a2pVerified:A,selectedRoom:u,selectedMessages:a,authUser:j,socket:c})]})}),n&&(0,i.jsx)("div",{class:"emailapp-wrap",children:(0,i.jsx)(T,{onShowAddForm:D,a2pVerified:A})})]})})})},F=()=>(0,i.jsx)("div",{children:(0,i.jsx)(t.A,{component:(0,i.jsx)(R,{})})})},11976:()=>{}}]);
//# sourceMappingURL=4282.8ff84e0a.chunk.js.map