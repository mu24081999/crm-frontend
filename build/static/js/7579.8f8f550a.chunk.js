"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[7579],{63218:(a,e,s)=>{s.d(e,{D:()=>l,F:()=>c});var n=s(55294),t=s(58077),r=s(75985);const i="".concat("https://desktopcrm.com:51/v1"),l=a=>async e=>{try{e((0,t.ro)());const s={headers:{"Content-Type":"application/json","x-access-token":a}};await n.Z.get("".concat(i,"/user/calling/user-messages"),s).then((a=>{var s;if(console.log("\ud83d\ude80 ~ .then ~ response:",a),200!==(null===a||void 0===a||null===(s=a.data)||void 0===s?void 0:s.statusCode))return r.Am.error(a.data.message),e((0,t.r6)(a.data.message));e((0,t.qu)(a.data.data.messagesData))}))}catch(s){e((0,t.r6)(s.message))}},c=(a,e)=>async s=>{try{s((0,t.ro)());const l={headers:{"Content-Type":"application/json","x-access-token":a}};await n.Z.post("".concat(i,"/user/calling/user-messages-logs"),e,l).then((a=>{var e;if(console.log("\ud83d\ude80 ~ .then ~ response:",a),200!==(null===a||void 0===a||null===(e=a.data)||void 0===e?void 0:e.statusCode))return r.Am.error(a.data.message),s((0,t.r6)(a.data.message));s((0,t.qu)(a.data.data.messagesData))}))}catch(l){s((0,t.r6)(l.message))}}},37579:(a,e,s)=>{s.r(e),s.d(e,{default:()=>C});var n=s(72791),t=s(34855),r=s(64869),i=s(54316),l=s(12187),c=s(56540),d=s(80184);const o=a=>{let{selectedContact:e,onChatDataFromChild:s,onContactsDataFromChild:n,onSelectedContactDataFromChild:t}=a;function o(a){const e=null===a||void 0===a?void 0:a.charAt(0),s=null===a||void 0===a?void 0:a.indexOf(" ");return{firstCharacter:e,characterAfterSpace:-1!==s?a.charAt(s+1):""}}return(0,d.jsxs)("header",{children:[(0,d.jsxs)("div",{className:"input-group contact-search-wrap d-none",children:[(0,d.jsx)("input",{type:"text",className:"form-control contact-search shadow-none",placeholder:"Search contact"}),(0,d.jsx)("a",{href:"javascript:void(0);",id:"contact_list_close",className:"btn btn-sm btn-icon btn-dark btn-rounded",children:(0,d.jsx)("span",{className:"icon",children:(0,d.jsx)("span",{className:"feather-icon",children:(0,d.jsx)(l.Lp2,{})})})})]}),(null===e||void 0===e?void 0:e.id)&&(0,d.jsx)("div",{className:"media-wrap",children:(0,d.jsxs)("div",{className:"media",children:[(0,d.jsx)("div",{className:"media-head",children:(0,d.jsx)("div",{class:"avatar avatar-sm avatar-primary position-relative avatar-rounded",children:(0,d.jsx)("span",{class:"initial-wrap",children:o(e.firstname+" "+e.lastname).firstCharacter+o(e.firstname+" "+e.lastname).characterAfterSpace})})}),(0,d.jsxs)("div",{className:"media-body",children:[(0,d.jsxs)("div",{className:"user-name",children:[null===e||void 0===e?void 0:e.firstname,"\xa0",null===e||void 0===e?void 0:e.lastname]}),(0,d.jsx)("div",{className:"user-status",children:null===e||void 0===e?void 0:e.phone})]})]})}),(0,d.jsxs)("div",{className:"chat-popup-action d-flex",children:[(0,d.jsx)("a",{href:"javascript:void(0);","data-bs-toggle":"dropdown",className:"btn btn-sm btn-icon btn-dark btn-rounded",children:(0,d.jsx)("span",{className:"icon",children:(0,d.jsx)("span",{className:"feather-icon",children:(0,d.jsx)(r.Nm0,{})})})}),(0,d.jsxs)("div",{className:"dropdown-menu",children:[(0,d.jsxs)("a",{className:"dropdown-item",href:"#",children:[(0,d.jsx)(i.Z3q,{}),(0,d.jsx)("span",{children:"Send push notifications"})]}),(0,d.jsxs)("a",{className:"dropdown-item",href:"#",children:[(0,d.jsx)(c.QYR,{size:24}),(0,d.jsx)("span",{children:"Mute Chat"})]})]}),(0,d.jsx)("a",{onClick:()=>{console.log("handleUsersClick"),n(!0),s(!1)},className:"btn btn-sm btn-icon btn-dark btn-rounded",children:(0,d.jsx)("span",{className:"icon",children:(0,d.jsx)("span",{className:"feather-icon",children:(0,d.jsx)(i.I$,{})})})}),(0,d.jsx)("a",{href:"javascript:void(0);",onClick:()=>{console.log("handle Close clicked"),n(!1),s(!1),t({})},className:"btn btn-sm btn-icon btn-dark btn-rounded",children:(0,d.jsx)("span",{className:"icon",children:(0,d.jsx)("span",{className:"feather-icon",children:(0,d.jsx)(l.Lp2,{})})})})]})]})},h=a=>{var e;let{contacts:s,onDataFromChild:n,onChatDataFromChild:t,onContactsDataFromChild:i,onMessagesDataFromChild:l,messages:c,authUser:o}=a;function h(a){const e=null===a||void 0===a?void 0:a.charAt(0),s=null===a||void 0===a?void 0:a.indexOf(" ");return{firstCharacter:e,characterAfterSpace:-1!==s?a.charAt(s+1):""}}return(0,d.jsx)("div",{className:"contact-list-wrap",children:(0,d.jsx)("ul",{className:"chat-contacts-list list-group list-group-flush",children:null===(e=Object.entries(s))||void 0===e?void 0:e.map((a=>{let[e,s]=a;return(0,d.jsxs)("li",{children:[(0,d.jsx)("div",{className:"title title-wth-divider text-primary my-3",children:(0,d.jsx)("span",{children:e})}),(0,d.jsx)("div",{children:null===s||void 0===s?void 0:s.map(((a,e)=>(0,d.jsx)("li",{className:"list-group-item",onClick:()=>(a=>{n(a),t(!0),i(!1);const e=(null===c||void 0===c?void 0:c.length)>0&&(null===c||void 0===c?void 0:c.filter((e=>e.from_phone===o.phone&&e.to_phone===a.phone||e.to_phone===o.phone&&e.from_phone===a.phone)));l(e)})(a),children:(0,d.jsxs)("div",{className:"media",children:[(0,d.jsx)("div",{className:"media-head",children:(0,d.jsx)("div",{class:"avatar avatar-sm avatar-primary position-relative avatar-rounded",children:(0,d.jsx)("span",{class:"initial-wrap",children:h(a.firstname+" "+a.lastname).firstCharacter+h(a.firstname+" "+a.lastname).characterAfterSpace})})}),(0,d.jsxs)("div",{className:"media-body",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"user-name",children:[null===a||void 0===a?void 0:a.firstname,"\xa0",null===a||void 0===a?void 0:a.lastname]}),(0,d.jsx)("div",{className:"user-status",children:null===a||void 0===a?void 0:a.phone})]}),(0,d.jsx)("div",{children:(0,d.jsxs)("div",{className:"dropdown action-drp",children:[(0,d.jsx)("a",{href:"#",className:"btn btn-icon btn-flush-dark btn-rounded flush-soft-hover dropdown-toggle no-caret","data-bs-toggle":"dropdown",children:(0,d.jsx)("span",{className:"icon",children:(0,d.jsx)("span",{className:"feather-icon",children:(0,d.jsx)(r.Nm0,{})})})}),(0,d.jsxs)("div",{className:"dropdown-menu dropdown-menu-end",children:[(0,d.jsx)("a",{className:"dropdown-item",href:"#",children:"Delete Chat"}),(0,d.jsx)("a",{className:"dropdown-item link-danger",href:"#",children:"Block"})]})]})})]})]})},e)))})]},e)}))})})};var m=s(72426),v=s.n(m);const p=a=>{let{selectedMessages:e,authUser:s,selectedContact:n}=a;function t(a){const e=null===a||void 0===a?void 0:a.charAt(0),s=null===a||void 0===a?void 0:a.indexOf(" ");return{firstCharacter:e,characterAfterSpace:-1!==s?a.charAt(s+1):""}}return console.log("\ud83d\ude80 ~ Chat ~ selectedMessages:",e),(0,d.jsx)("ul",{className:"list-unstyled",children:Object.entries(e).map((a=>{let[e,r]=a;return(0,d.jsxs)("div",{children:[(0,d.jsx)("li",{className:"day-sep",children:(0,d.jsx)("span",{children:e})}),null===r||void 0===r?void 0:r.map(((a,e)=>(0,d.jsx)("div",{children:(null===a||void 0===a?void 0:a.from_phone)!==s.phone?(0,d.jsxs)("li",{className:"media received",children:[(0,d.jsx)("div",{class:"avatar avatar-sm avatar-primary position-relative avatar-rounded",children:(0,d.jsx)("span",{class:"initial-wrap",children:t(n.firstname+" "+n.lastname).firstCharacter+t(n.firstname+" "+n.lastname).characterAfterSpace})}),(0,d.jsx)("div",{className:"media-body",children:(0,d.jsx)("div",{className:"msg-box",children:(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{children:null===a||void 0===a?void 0:a.message}),(0,d.jsx)("span",{className:"chat-time",children:v()(null===a||void 0===a?void 0:a.created_at).format("HH:mm a")})]})})})]}):(0,d.jsx)("li",{className:"media sent",children:(0,d.jsx)("div",{className:"media-body",children:(0,d.jsx)("div",{className:"msg-box",children:(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{children:null===a||void 0===a?void 0:a.message}),(0,d.jsx)("span",{className:"chat-time",children:v()(null===a||void 0===a?void 0:a.created_at).format("HH:mm a")})]})})})})},e)))]},e)}))})};var x=s(94420),u=s(12202),j=s(29750);const f=a=>{let{selectedContact:e,authUser:s}=a;const[t,r]=(0,n.useState)(""),{sendTextMessage:i}=(0,n.useContext)(j.J);return(0,d.jsx)("footer",{children:(0,d.jsxs)("div",{className:"input-group",children:[(0,d.jsxs)("div",{className:"input-group-text overflow-show border-0",children:[(0,d.jsx)("button",{className:"btn btn-icon btn-flush-dark flush-soft-hover btn-rounded dropdown-toggle no-caret","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:(0,d.jsx)("span",{className:"icon",children:(0,d.jsx)("span",{className:"feather-icon",children:(0,d.jsx)("i",{"data-feather":"share"})})})}),(0,d.jsxs)("div",{className:"dropdown-menu",children:[(0,d.jsx)("a",{className:"dropdown-item",href:"#",children:(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("div",{className:"avatar avatar-icon avatar-xs avatar-soft-primary avatar-rounded me-3",children:(0,d.jsx)("span",{className:"initial-wrap",children:(0,d.jsx)("i",{className:"ri-image-line"})})}),(0,d.jsx)("div",{children:(0,d.jsx)("span",{className:"h6 mb-0",children:"Photo or Video Library"})})]})}),(0,d.jsx)("a",{className:"dropdown-item",href:"#",children:(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("div",{className:"avatar avatar-icon avatar-xs avatar-soft-info avatar-rounded me-3",children:(0,d.jsx)("span",{className:"initial-wrap",children:(0,d.jsx)("i",{className:"ri-file-4-line"})})}),(0,d.jsx)("div",{children:(0,d.jsx)("span",{className:"h6 mb-0",children:"Documents"})})]})}),(0,d.jsx)("a",{className:"dropdown-item",href:"#",children:(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("div",{className:"avatar avatar-icon avatar-xs avatar-soft-success avatar-rounded me-3",children:(0,d.jsx)("span",{className:"initial-wrap",children:(0,d.jsx)("i",{className:"ri-map-pin-line"})})}),(0,d.jsx)("div",{children:(0,d.jsx)("span",{className:"h6 mb-0",children:"Location"})})]})}),(0,d.jsx)("a",{className:"dropdown-item",href:"#",children:(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("div",{className:"avatar avatar-icon avatar-xs avatar-soft-blue avatar-rounded me-3",children:(0,d.jsx)("span",{className:"initial-wrap",children:(0,d.jsx)("i",{className:"ri-contacts-line"})})}),(0,d.jsx)("div",{children:(0,d.jsx)("span",{className:"h6 mb-0",children:"Contact"})})]})})]})]}),(0,d.jsx)("input",{type:"text",onChange:a=>r(a.target.value),value:t,onKeyUp:a=>(a=>{if("Enter"===a.key){const a={from:{phone:s.phone,name:s.name,avatar:s.avatar,socket_id:s.socket_id},to:{phone:e.phone,name:e.firstname+(null===e||void 0===e?void 0:e.lastname),avatar:e.avatar},message:t};i(a),r("")}})(a),name:"send-msg",className:"input-msg-send form-control border-0 shadow-none",placeholder:"Type something..."}),(0,d.jsx)("div",{className:"input-group-text overflow-show border-0",children:(0,d.jsx)("button",{className:"btn btn-icon btn-flush-dark flush-soft-hover btn-rounded",children:(0,d.jsx)("span",{className:"icon",children:(0,d.jsx)("span",{className:"feather-icon",children:(0,d.jsx)(u.sr,{})})})})})]})})};var N=s(61765),g=s(63218);const b=()=>{const{messagesArray:a}=(0,n.useContext)(j.J),[e,s]=(0,n.useState)([]),[t,r]=(0,n.useState)([]),[i,l]=(0,n.useState)({}),[c,m]=(0,n.useState)({}),[v,u]=(0,n.useState)(!0),[b,C]=(0,n.useState)(!1),{contacts:w}=(0,x.v9)((a=>a.contact)),{messages:y}=(0,x.v9)((a=>a.message)),{token:k,user:D}=(0,x.v9)((a=>a.auth)),S=(0,x.I0)();(0,n.useEffect)((()=>{r(a);const e=(null===a||void 0===a?void 0:a.length)>0&&(null===a||void 0===a?void 0:a.reduce(((a,e)=>{const s=e.created_at.slice(0,10);return a[s]||(a[s]=[]),a[s].push(e),a}),{}));l(e)}),[a]),(0,n.useEffect)((()=>{r(y)}),[y]),(0,n.useEffect)((()=>{S((0,N.SN)(k)),S((0,g.D)(k))}),[k,S]),(0,n.useEffect)((()=>{if((null===w||void 0===w?void 0:w.length)>0){const a=null===w||void 0===w?void 0:w.reduce(((a,e)=>{var s,n;const t=null===e||void 0===e||null===(s=e.firstname)||void 0===s||null===(n=s.charAt(0))||void 0===n?void 0:n.toUpperCase();return a[t]=[...a[t]||[],e],a}),{});s(a)}}),[w]);const A=a=>{m(a)},F=a=>{u(a)},_=a=>{C(a)};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"hk-chat-popup d-flex",children:[(0,d.jsx)(o,{selectedContact:c,onContactsDataFromChild:F,onChatDataFromChild:_,onSelectedContactDataFromChild:A}),(0,d.jsx)("div",{className:"chat-popup-body",children:(0,d.jsx)("div",{"data-simplebar":!0,className:"nicescroll-bar",children:(0,d.jsxs)("div",{children:[v&&(0,d.jsx)(h,{contacts:e,messages:t,authUser:D,onMessagesDataFromChild:a=>{const e=(null===a||void 0===a?void 0:a.length)>0&&(null===a||void 0===a?void 0:a.reduce(((a,e)=>{const s=e.created_at.slice(0,10);return a[s]||(a[s]=[]),a[s].push(e),a}),{}));l(e)},onDataFromChild:A,onContactsDataFromChild:F,onChatDataFromChild:_}),b&&(0,d.jsx)(p,{selectedContact:c,selectedMessages:i,authUser:D})]})})}),(0,d.jsx)(f,{authUser:D,selectedContact:c})]}),(0,d.jsx)("a",{href:"#",className:"btn btn-icon btn-floating btn-primary btn-lg btn-rounded btn-popup-open",children:(0,d.jsx)("span",{className:"icon",children:(0,d.jsx)("span",{className:"feather-icon",children:(0,d.jsx)("i",{"data-feather":"message-circle"})})})}),(0,d.jsx)("div",{className:"chat-popover shadow-xl",children:(0,d.jsx)("p",{children:"Try Jampack Chat for free and connect with your customers now!"})}),(0,d.jsx)("div",{className:"hk-pg-wrapper pb-0",children:(0,d.jsx)("div",{className:"hk-pg-body py-0"})})]})},C=()=>(0,d.jsx)("div",{children:(0,d.jsx)(t.Z,{component:(0,d.jsx)(b,{})})})}}]);
//# sourceMappingURL=7579.8f8f550a.chunk.js.map