(self.webpackChunkclient=self.webpackChunkclient||[]).push([[5909],{92135:(e,s,a)=>{"use strict";a.d(s,{Z:()=>o});a(72791);var t=a(12202),n=a(80184);const o=function(e){let s,{fileType:a,fileUrl:o,fileWidth:i}=e;switch(a){case"jpeg":case"png":case"jpg":s=(0,n.jsx)("img",{className:"img-fluid rounded",style:{maxWidth:"300px"},src:o,width:i,alt:" preview"});break;case"pdf":s=(0,n.jsx)(t.yRW,{});break;case"zip":s=(0,n.jsx)(t.H5T,{});break;case"video":s=(0,n.jsxs)("video",{controls:!0,width:i,height:"auto",children:[(0,n.jsx)("source",{src:o,type:"video/mp4"}),"Your browser does not support the video tag."]});break;default:s=(0,n.jsx)(t.bz6,{color:"white",size:70,n:!0})}return(0,n.jsx)("div",{className:"",children:s})}},71865:(e,s,a)=>{"use strict";a.d(s,{Z:()=>c});var t=a(72791),n=a(61134),o=a(763),i=a.n(o),l=a(49687),r=a(80184);const d=t.forwardRef(((e,s)=>{const{field:a}=(0,n.bc)(e),[o,d]=(0,t.useState)(!1),[c,u]=(0,t.useState)(""),h=(0,t.useRef)(null),{title:v,style:m,isHighLight:p=!1,type:f,errors:x,defaultValue:g,customStyle:j,onChange:b,ellipses:y,label:k,...w}=e;let _=i().get(x,e.name);return(0,t.useEffect)((()=>{f&&""!==f&&u(f)}),[f]),(0,r.jsxs)("div",{className:"w-full mb-5",children:[(0,r.jsxs)("div",{className:"".concat(m?"bg-white":"","  ").concat(null!==e&&void 0!==e&&e.rules&&_?"focus-within:border-red-600 border-red-600":"focus-within:border-teal-c-900"),children:[(0,r.jsx)(n.Qr,{name:null===e||void 0===e?void 0:e.name,control:null===e||void 0===e?void 0:e.control,rules:null===e||void 0===e?void 0:e.rules,className:"form-group",defaultValue:""!==g?g:"",render:s=>{let{field:a}=s;return(0,r.jsxs)("div",{className:"",style:{height:"280px",overflow:"hidden"},children:[k&&(0,r.jsx)("label",{class:"form-label-group",children:k}),(0,r.jsx)(l.M,{...e,...w,apiKey:"tnm05u4rxvm3tav3sjqqew5pngxe7zeju5e2zfh392oi034c",onKeyUp:e=>{u(""),a.onChange(h.current.getContent())},onInit:(e,s)=>h.current=s,initialValue:"edit"===c&&a.value||"<p>Put your content here.</p>",init:{height:300,menubar:!1,plugins:["a11ychecker advcode casechange formatpainter","linkchecker autolink lists checklist","media mediaembed pageembed permanentpen","powerpaste table advtable tinymcespellchecker"],toolbar:"formatselect | fontselect | bold italic strikethrough   formatpainter | alignleft aligncenter alignright alignjustify | numlist bullist outdent indent | link insertfile image | removeformat | code | addcomment | checklist | casechange",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }, .tox-statusbar{display:none}"}})]})}}),(0,r.jsx)("div",{className:"pointer-events-none absolute ml-2 left-0 duration-300 origin-0 mr-2 inline-block px-1 font-normal  ".concat(null!==e&&void 0!==e&&e.rules&&_?"text-red-600":"text-gray-600","  ").concat(o||""===!a.value||"0"===a.value?"-top-2 duration-300 bg-[white] text-xs rounded-lg":"top-2 duration-300 text-base xl:top-1 ".concat(y&&"w-[98%] text-ellipsis overflow-hidden whitespace-nowrap")," \n            ").concat(p&&" bg-highLight  ","  \n            ")})]}),e.rules&&_&&(0,r.jsx)("p",{className:"text-xs p-1 text-danger",id:"email-error",children:e.rules&&_&&e.rules&&(null===_||void 0===_?void 0:_.message)})]})}));d.displayName="EditorField";const c=d},91524:(e,s,a)=>{"use strict";a.d(s,{L3:()=>u,NU:()=>r,Ss:()=>c,Xg:()=>h,si:()=>d,x0:()=>l});var t=a(55294),n=a(78657),o=a(75985);const i="".concat("https://desktopcrm.com:51/v1"),l=(e,s,a,l)=>async r=>{try{r((0,n.sI)());const d={headers:{"Content-Type":"application/json","x-access-token":e}};await t.Z.get("".concat(i,"/user/email/get-emails/").concat(s,"/").concat(a,"/").concat(l),d).then((e=>{var s;if(200!==(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.statusCode))return o.Am.error(e.data.message),r((0,n.r6)(e.data.message));r((0,n.G5)(e.data.data.emailsData))}))}catch(d){r((0,n.r6)(d.message))}},r=(e,s)=>async a=>{try{a((0,n.sI)());const l={headers:{"Content-Type":"application/json","x-access-token":e}};await t.Z.post("".concat(i,"/user/email/get-emails-by-email"),s,l).then((e=>{var s;if(200!==(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.statusCode))return o.Am.error(e.data.message),a((0,n.r6)(e.data.message));a((0,n.G5)(e.data.data.emailsData))}))}catch(l){a((0,n.r6)(l.message))}},d=(e,s)=>async a=>{try{a((0,n.sI)());const l={headers:{"Content-Type":"multipart/form-data","x-access-token":e}};await t.Z.post("".concat(i,"/user/email/send-email"),s,l).then((e=>{var s;if(200!==(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.statusCode))return o.Am.error(e.data.message),a((0,n.r6)(e.data.message));a((0,n.Cz)(e.data.message)),o.Am.success(e.data.message)}))}catch(l){a((0,n.r6)(l.message))}},c=(e,s)=>async a=>{try{a((0,n.sI)());const l={headers:{"Content-Type":"multipart/form-data","x-access-token":e}};await t.Z.post("".concat(i,"/user/email/send-email-bulk"),s,l).then((e=>{var s;if(console.log(e),200!==(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.statusCode))return o.Am.error(e.data.message),a((0,n.r6)(e.data.message));a((0,n.Cz)(e.data.message)),o.Am.success(e.data.message)}))}catch(l){a((0,n.r6)(l.message))}},u=(e,s,a)=>async r=>{try{r((0,n.sI)());const d={headers:{"Content-Type":"application/json","x-access-token":e}};await t.Z.put("".concat(i,"/user/email/update-email/").concat(s),a,d).then((s=>{var t;if(200!==(null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t.statusCode))return o.Am.error(s.data.message),r((0,n.r6)(s.data.message));r((0,n.s)(s.data.message)),r(l(e,a.user_email,20,1)),o.Am.success(s.data.message)}))}catch(d){r((0,n.r6)(d.message))}},h=(e,s)=>async a=>{try{a((0,n.sI)());const r={headers:{"Content-Type":"application/json","x-access-token":e}};await t.Z.delete("".concat(i,"/user/email/delete-email/").concat(s),r).then((s=>{var t;if(200!==(null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t.statusCode))return o.Am.error(s.data.message),a((0,n.r6)(s.data.message));a((0,n.s)(s.data.message)),a(l(e)),o.Am.success(s.data.message)}))}catch(r){a((0,n.r6)(r.message))}}},63218:(e,s,a)=>{"use strict";a.d(s,{D:()=>l,F:()=>r});var t=a(55294),n=a(58077),o=a(75985);const i="".concat("https://desktopcrm.com:51/v1"),l=e=>async s=>{try{s((0,n.ro)());const a={headers:{"Content-Type":"application/json","x-access-token":e}};await t.Z.get("".concat(i,"/user/calling/user-messages"),a).then((e=>{var a;if(console.log("\ud83d\ude80 ~ .then ~ response:",e),200!==(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.statusCode))return o.Am.error(e.data.message),s((0,n.r6)(e.data.message));s((0,n.qu)(e.data.data.messagesData))}))}catch(a){s((0,n.r6)(a.message))}},r=(e,s)=>async a=>{try{a((0,n.ro)());const l={headers:{"Content-Type":"application/json","x-access-token":e}};await t.Z.post("".concat(i,"/user/calling/user-messages-logs"),s,l).then((e=>{var s;if(console.log("\ud83d\ude80 ~ .then ~ response:",e),200!==(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.statusCode))return o.Am.error(e.data.message),a((0,n.r6)(e.data.message));a((0,n.qu)(e.data.data.messagesData))}))}catch(l){a((0,n.r6)(l.message))}}},12507:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>F});var t=a(72791),n=a(34855),o=a(12202),i=a(80184);const l=e=>{let{rooms:s,authUser:a,onDataFromChild:n,messages:l,onMessagesDataFromChild:r,a2pVerified:d}=e;const[c,u]=(0,t.useState)(""),[h,v]=(0,t.useState)([]),[m,p]=(0,t.useState)([]);(0,t.useEffect)((()=>{p(s),v(s)}),[s]);function f(e){const s=new Date(e),a=new Date,t=new Date(a);if(t.setDate(a.getDate()-1),s.toDateString()===a.toDateString())return"Today";if(s.toDateString()===t.toDateString())return"Yesterday";{const e={year:"numeric",month:"long",day:"numeric"};return s.toLocaleDateString("en-US",e)}}return(0,i.jsxs)("div",{children:[(0,i.jsx)("form",{class:"aside-search",role:"search",children:(0,i.jsx)("input",{type:"text",class:"form-control",placeholder:"Search Chats",onKeyUp:e=>{if(console.log(e.target.value),""!==e.target.value||void 0!==e.target.value){const s=(null===h||void 0===h?void 0:h.length)>0&&(null===h||void 0===h?void 0:h.filter((s=>{var a,t;return(null===s||void 0===s||null===(a=s.to_phone)||void 0===a?void 0:a.includes(e.target.value))||(null===s||void 0===s||null===(t=s.to_name)||void 0===t?void 0:t.includes(e.target.value))})));p(s)}else p(h)}})})," ",(0,i.jsx)("ul",{class:"chat-contacts-list list-group list-group-flush",children:(null===m||void 0===m?void 0:m.length)>0?null===m||void 0===m?void 0:m.map(((e,s)=>{const t=(null===m||void 0===m?void 0:m.length)>0&&(null===m||void 0===m?void 0:m.filter((s=>s.from_phone===a.phone&&s.to_phone===e.to_phone&&s.user_id===a.id||s.to_phone===a.phone&&s.from_phone===e.from_phone&&"inbound"===(null===s||void 0===s?void 0:s.direction)))),d=t[t.length-1];return(0,i.jsx)("li",{class:"list-group-item",onClick:()=>(e=>{u(e),n(e);const s=(null===l||void 0===l?void 0:l.length)>0&&(null===l||void 0===l?void 0:l.filter((s=>s.from_phone===a.phone&&s.to_phone===e.to_phone&&s.user_id===a.id||s.to_phone===a.phone&&s.from_phone===e.from_phone&&"inbound"===(null===s||void 0===s?void 0:s.direction))));r(s)})(e),children:(0,i.jsxs)("div",{class:"media",children:[(0,i.jsx)("div",{class:"media-head",children:(0,i.jsx)("div",{class:"avatar avatar-sm avatar-primary position-relative avatar-rounded",children:(0,i.jsx)("span",{class:"initial-wrap",children:(0,i.jsx)(o.q1E,{})})})}),(0,i.jsxs)("div",{class:"media-body",children:[(0,i.jsx)("div",{children:(0,i.jsx)("div",{class:"user-name",children:"outbound"===(null===e||void 0===e?void 0:e.direction)?null===e||void 0===e?void 0:e.to_phone:null===e||void 0===e?void 0:e.from_phone})}),(0,i.jsx)("div",{children:(0,i.jsx)("div",{class:"last-chat-time",children:null!==d&&void 0!==d&&d.created_at?f((null===d||void 0===d?void 0:d.created_at)||new Date):"..."})})]})]})},s)})):(0,i.jsx)("li",{children:"No rooms till."})})]})};var r=a(39934);const d=e=>{let{rooms:s,authUser:a,socket:t,onDataFromChild:n,messages:d,onMessagesDataFromChild:c,onShowAddForm:u,a2pVerified:h}=e;return(0,i.jsxs)("div",{children:[" ",(0,i.jsxs)("div",{class:"chatapp-aside",children:[(0,i.jsxs)("header",{class:"aside-header",children:[(0,i.jsxs)("h1",{className:"fs-5 fw-bold",children:[(0,i.jsx)("span",{className:"pe-2",children:(0,i.jsx)(o.SRX,{size:30,color:"#007D88"})}),"SMS Marketting"]}),(0,i.jsx)("a",{href:"/",class:"btn btn-icon btn-rounded show-compose-popup btn-primary",onClick:()=>u(!0),children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)(r.EaF,{})})})})]}),(0,i.jsxs)("div",{"data-simplebar":!0,class:"aside-body",children:[(0,i.jsx)("div",{className:"alert alert-warning",children:h?(0,i.jsx)(i.Fragment,{}):(0,i.jsxs)("p",{children:["A2P Verfification is required for conversation in US/Canada.\xa0",(0,i.jsx)("a",{href:"#","data-bs-target":"#a2p-modal","data-bs-toggle":"modal",className:"text-underline",children:(0,i.jsx)("ins",{children:"Add Details"})})]})}),(0,i.jsx)(l,{rooms:s,authUser:a,a2pVerified:h,socket:t,onDataFromChild:n,messages:d,onMessagesDataFromChild:c})]})]})]})};a(763);var c=a(72426),u=a.n(c),h=a(74912),v=a.n(h),m=a(92135),p=a(29750),f=a(94420),x=a(98911),g=a(13974),j=(a(67366),a(57467)),b=a(75985);const y=e=>{let{messages:s,selectedRoom:a,authUser:n,socket:l,selectedMessages:r,a2pVerified:d}=e;const{sendTextMessage:c}=(0,t.useContext)(p.J),[h,y]=(0,t.useState)(null),[k,w]=(0,t.useState)(null),{users:_}=(0,f.v9)((e=>e.user)),{balanceDetails:S}=(0,f.v9)((e=>e.balance)),{token:C,user:A}=(0,f.v9)((e=>e.auth)),N=(0,f.I0)();(0,t.useEffect)((()=>{(null===r||void 0===r?void 0:r.length)>0&&document.getElementById("dummy_avatar").scrollIntoView({behavior:"smooth",block:"end"})}),[r]),(0,t.useEffect)((()=>{(null===_||void 0===_?void 0:_.length)>0&&w(_)}),[_]),(0,t.useEffect)((()=>{C&&N((0,x.Rf)(C))}),[C,N]),(0,t.useEffect)((()=>{const e=a.user_id_1===n.id?a.user_id_2:a.user_id_1;if((null===k||void 0===k?void 0:k.length)>0){const s=null===k||void 0===k?void 0:k.filter((s=>s.id===e));y(s[0])}}),[k,n,a]);const[E,D]=(0,t.useState)(null),[T,I]=(0,t.useState)([]),[F,U]=(0,t.useState)(),V=e=>{if(null!==(null===A||void 0===A?void 0:A.phone)&&void 0!==(null===A||void 0===A?void 0:A.phone)&&""!==(null===A||void 0===A?void 0:A.phone))if(parseInt(null===S||void 0===S?void 0:S.credit)>0)if(null!==F){if("Enter"===e.key||"click"===e.type){const e={from:{phone:n.phone,name:n.name,avatar:n.avatar,socket_id:n.socket_id,accountSid:null===n||void 0===n?void 0:n.accountSid,authToken:null===n||void 0===n?void 0:n.authToken},to:{phone:null===a||void 0===a?void 0:a.to_phone,name:(null===a||void 0===a?void 0:a.firstname)+(null===a||void 0===a?void 0:a.lastname),avatar:null===a||void 0===a?void 0:a.avatar},message:F};null!==a&&void 0!==a&&a.includes("+1")&&!d?b.Am.warn("A2P verification is required for conversation in US/Canada."):c(e),U(null)}}else b.Am.error("Please write something in the message.");else b.Am.error("You have insufficient balance to send the message.");else b.Am.error("Please configure you number first, then you are able to send a message.")};(0,t.useEffect)((()=>{document.getElementById("dummy_avatar").scrollIntoView({behavior:"smooth",block:"end"}),v().config.update({accessKeyId:"AKIAX2CISY6LNJB3XTIK",secretAccessKey:"zA+9Ypk4sNqNl9HlY2zmBoEI4edXTEonDUwE2ZAU",region:"eu-west-2"});const e=new(v().S3);(async()=>{const s={Bucket:"jampackcrm"};try{const a=await e.listObjectsV2(s).promise();I(a.Contents)}catch(a){console.error("Error fetching objects:",a)}})()}),[]);const Z=async(e,s)=>{const a=new(v().S3),t={Bucket:e,Key:s};try{const e=await a.getObject(t).promise(),n=URL.createObjectURL(new Blob([e.Body])),o=document.createElement("a");o.href=n,o.setAttribute("download",s),document.body.appendChild(o),o.click(),document.body.removeChild(o)}catch(n){console.error("Error downloading file:",n)}},z=e=>null===T||void 0===T?void 0:T.filter((s=>s.Key===e));function M(e){return null===e||void 0===e?void 0:e.split(".").pop().toLowerCase()}function B(e){const s=null===e||void 0===e?void 0:e.charAt(0),a=null===e||void 0===e?void 0:e.indexOf(" ");return{firstCharacter:s,characterAfterSpace:-1!==a?e.charAt(a+1):""}}return(0,i.jsxs)("div",{class:"chatapp-single-chat",children:[(0,i.jsxs)("header",{class:"chat-header",children:[(0,i.jsx)("a",{id:"back_user_list",class:"btn btn-sm btn-icon btn-flush-dark btn-rounded flush-soft-hover back-user-list",href:"/",children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)("i",{"data-feather":"chevron-left"})})})}),(0,i.jsxs)("div",{class:"media",children:[(0,i.jsx)("div",{class:"media-head",children:(0,i.jsx)("div",{class:"avatar avatar-sm avatar-primary position-relative avatar-rounded",children:(0,i.jsx)("span",{class:"initial-wrap",children:(0,i.jsx)(o.q1E,{})})})}),(0,i.jsx)("div",{class:"media-body",children:(0,i.jsxs)("div",{class:"user-name",children:[" ","outbound"===(null===a||void 0===a?void 0:a.direction)?null===a||void 0===a?void 0:a.to_phone:null===a||void 0===a?void 0:a.from_phone]})})]})]}),(0,i.jsx)("div",{"data-simplebar":!0,id:"chat_body",class:"chat-body",children:(0,i.jsx)("ul",{id:"dummy_avatar",class:"list-unstyled chat-single-list",children:(null===r||void 0===r?void 0:r.length)>0?r.map(((e,s)=>(null===e||void 0===e?void 0:e.from_phone)!==(null===n||void 0===n?void 0:n.phone)?(0,i.jsxs)("li",{class:"media received",children:[(0,i.jsx)("div",{class:"avatar avatar-sm avatar-primary position-relative avatar-rounded",children:(0,i.jsx)("span",{class:"initial-wrap",children:B(a.firstname+" "+a.lastname).firstCharacter+B(a.firstname+" "+a.lastname).characterAfterSpace})}),(0,i.jsx)("div",{class:"media-body",children:(0,i.jsxs)("div",{class:"msg-box",children:[(0,i.jsxs)("div",{children:[(null===e||void 0===e?void 0:e.file_key)&&(0,i.jsx)("button",{style:{border:"none",background:"none"},onClick:()=>{var s;return Z("jampackcrm",null===(s=z(e.file_key)[0])||void 0===s?void 0:s.Key)},children:(0,i.jsx)(m.Z,{fileType:M(null===e||void 0===e?void 0:e.file_key),fileUrl:"https://s3.eu-west-2.amazonaws.com/jampackcrm/".concat(null===e||void 0===e?void 0:e.file_key)})}),(0,i.jsx)("p",{children:e.message}),(0,i.jsxs)("span",{class:"chat-time",children:[u()(null===F||void 0===F?void 0:F.created_at).format("h:mm A"),(0,i.jsxs)("span",{className:"float-end",children:[" ",(null===e||void 0===e?void 0:e.file_key)&&((null===e||void 0===e?void 0:e.file_size)/1048576).toFixed(2)+" mb"]})]})]}),(0,i.jsxs)("div",{class:"msg-action",children:[(0,i.jsx)("a",{href:"/",class:"btn btn-icon btn-flush-dark btn-rounded flush-soft-hover no-caret",children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)("i",{"data-feather":"corner-up-right"})})})}),(0,i.jsx)("a",{href:"/",class:"btn btn-icon btn-flush-dark btn-rounded flush-soft-hover dropdown-toggle no-caret","data-bs-toggle":"dropdown",children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)("i",{"data-feather":"more-horizontal"})})})}),(0,i.jsxs)("div",{class:"dropdown-menu dropdown-menu-end",children:[(0,i.jsx)("a",{class:"dropdown-item",href:"/",children:"Forward"}),(0,i.jsx)("a",{class:"dropdown-item",href:"/",children:"Copy"})]})]})]})})]},s):(0,i.jsx)("li",{class:"media sent d-flex",children:(0,i.jsx)("div",{class:"media-body",style:{display:"flex"},children:(0,i.jsxs)("div",{className:"d-flex",children:[(0,i.jsx)("div",{class:"msg-box",children:(0,i.jsxs)("div",{children:[(null===e||void 0===e?void 0:e.file_key)&&(0,i.jsx)("button",{style:{border:"none",background:"none"},onClick:()=>{var s;return Z("jampackcrm",null===(s=z(e.file_key)[0])||void 0===s?void 0:s.Key)},children:(0,i.jsx)(m.Z,{fileType:M(null===e||void 0===e?void 0:e.file_key),fileUrl:"https://s3.eu-west-2.amazonaws.com/jampackcrm/".concat(null===e||void 0===e?void 0:e.file_key)})}),(0,i.jsx)("p",{children:e.message}),(0,i.jsxs)("span",{class:"chat-time",children:[u()(null===F||void 0===F?void 0:F.created_at).format("h:mm A"),(0,i.jsxs)("span",{className:"float-end",children:[" ",(null===e||void 0===e?void 0:e.file_key)&&((null===e||void 0===e?void 0:e.file_size)/1048576).toFixed(2)+" mb"]})]})]})}),(0,i.jsx)("div",{className:"",children:null===(null===e||void 0===e?void 0:e.sid)&&(0,i.jsx)("div",{class:"media-head",children:(0,i.jsx)("div",{class:"avatar avatar-sm avatar-secondary position-relative avatar-rounded",children:(0,i.jsx)(j.Z,{trigger:(0,i.jsx)("button",{className:"btn btn-icon btn-floating btn-secondary btn-lg btn-rounded shadow-lg",id:"dialer_button",children:(0,i.jsx)(g.BJv,{color:"red",size:"24",style:{marginTop:"-15%"}})}),position:"bottom right",children:(0,i.jsx)("p",{className:"",children:null===e||void 0===e?void 0:e.message_error})})})})})]})})},s))):(0,i.jsx)("li",{children:" No Messages"})})}),(0,i.jsxs)("footer",{class:"chat-footer d-flex gap-2",children:[(0,i.jsx)("div",{children:(0,i.jsx)("button",{className:"btn btn-secondary shadow rounded-circle  float-end",style:{width:"35px",height:"35px"},onClick:()=>document.getElementById("dummy_avatar").scrollIntoView({behavior:"smooth",block:"end"}),children:(0,i.jsx)(o.NWQ,{style:{marginLeft:"-7px",marginBottom:"4px"}})})}),(0,i.jsx)("div",{class:"input-group",children:(0,i.jsxs)("span",{class:"input-affix-wrapper",children:[(0,i.jsx)("input",{type:"text",name:"send-msg",class:"input-msg-send form-control rounded-input",placeholder:"Type your message...",value:F,onChange:e=>U(e.target.value),onKeyUp:e=>"Enter"===e.key&&V(e)}),(0,i.jsx)("span",{class:"input-suffix",children:(0,i.jsx)("button",{class:"btn btn-icon btn-flush-primary btn-rounded btn-send",onClick:e=>V(e),children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)(o.Rdr,{})})})})]})})]}),(0,i.jsx)("div",{class:"chat-info",children:(0,i.jsxs)("div",{"data-simplebar":!0,class:"nicescroll-bar",children:[(0,i.jsx)("button",{type:"button",class:"info-close btn-close",children:(0,i.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}),(0,i.jsxs)("div",{class:"text-center",children:[(0,i.jsx)("div",{class:"avatar avatar-xxl avatar-rounded",children:(0,i.jsx)("img",{src:((null===a||void 0===a?void 0:a.user_id_1)===(null===n||void 0===n?void 0:n.id)?null===a||void 0===a?void 0:a.user_image_2:null===a||void 0===a?void 0:a.user_image_1)||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg",alt:"user",class:"avatar-img"})}),(0,i.jsxs)("div",{class:"cp-name text-truncate mt-2",children:[" ",null===a||void 0===a?void 0:a.to_phone]}),(0,i.jsx)("p",{class:"text-truncate",children:"No phone calls Always busy"})]})]})})]})};var k=a(91608),w=a(61765),_=a(63218),S=a(61134),C=a(76041),A=a(64869),N=a(14794),E=(a(45523),a(59110)),D=(a(91524),a(71865),a(22316));const T=e=>{let{onShowAddForm:s,a2pVerified:a}=e;const{sendTextMessage:n}=(0,t.useContext)(p.J),{handleSubmit:l,watch:r,control:d,setValue:c,reset:u,formState:{errors:h}}=(0,S.cI)(),v=r("body"),m=(0,f.I0)(),{token:g,user:j}=(0,f.v9)((e=>e.auth)),{balanceDetails:y}=(0,f.v9)((e=>e.balance)),[k,w]=(0,t.useState)(!1),[_,T]=(0,t.useState)([]);(0,t.useEffect)((()=>{m((0,x.Rf)(g))}),[g,m]);return(0,i.jsx)("div",{class:"compose-email-popup",children:(0,i.jsxs)("div",{class:"d-flex flex-column",children:[(0,i.jsxs)("header",{class:"d-flex align-items-center justify-content-between",children:[(0,i.jsx)("h6",{class:"text-white mb-0",children:"Compose Bulk"}),(0,i.jsxs)("div",{class:"d-flex",children:[(0,i.jsx)("button",{id:"min_compose_popup",class:"btn btn-sm btn-icon btn-dark btn-rounded d-lg-block d-none",children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)(o.iFH,{})})})}),(0,i.jsx)("button",{id:"max_compose_popup",class:"btn btn-sm btn-icon btn-dark btn-rounded d-lg-block d-none",children:(0,i.jsxs)("span",{class:"icon",children:[(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)(N.cyL,{})}),(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)(A.sEI,{})})]})}),(0,i.jsx)("button",{id:"close_compose_popup",class:"btn btn-sm btn-icon btn-dark btn-rounded",onClick:()=>s(!1),children:(0,i.jsx)("span",{class:"icon",children:(0,i.jsx)("span",{class:"feather-icon",children:(0,i.jsx)(C.$iT,{})})})})]})]}),k?(0,i.jsx)(D.Z,{}):(0,i.jsxs)("form",{onSubmit:l((async e=>{try{if(null!==(null===j||void 0===j?void 0:j.phone)&&void 0!==(null===j||void 0===j?void 0:j.phone)&&""!==(null===j||void 0===j?void 0:j.phone))if(parseInt(null===y||void 0===y?void 0:y.credit)>0)if(a){var s,t;if(w(!0),_.length>0)await Promise.all(_.map((async e=>{const s={from:{phone:j.phone,name:j.name,avatar:j.avatar,socket_id:j.socket_id,accountSid:null===j||void 0===j?void 0:j.accountSid,authToken:null===j||void 0===j?void 0:j.authToken},to:{phone:e},user_id:null===j||void 0===j?void 0:j.id,message:v};console.log(s),await n(s)})));else if((null===e||void 0===e||null===(s=e.to)||void 0===s||null===(t=s.split("\n"))||void 0===t?void 0:t.length)>0){var o;const s=null===e||void 0===e||null===(o=e.to)||void 0===o?void 0:o.split("\n");await Promise.all(s.map((async e=>{const s={from:{phone:j.phone,name:j.name,avatar:j.avatar,socket_id:j.socket_id,accountSid:null===j||void 0===j?void 0:j.accountSid,authToken:null===j||void 0===j?void 0:j.authToken},to:{phone:e},message:v,user_id:null===j||void 0===j?void 0:j.id};await n(s)})))}w(!1),b.Am.success("SMS are successfully added to pipeline.")}else b.Am.warn("A2P Verification is required to process this marketting.");else b.Am.error("You have insufficient balance to send message.");else b.Am.error("Please configure you number first, then you are able to send a message.")}catch(i){console.error("Error sending SMS messages:",i)}})),style:{maxHeight:"600px",overflow:"scroll",scrollBehavior:"smooth"},children:[(0,i.jsx)("div",{className:"w-100",children:(0,i.jsx)(E.Z,{name:"to",height:"150px",placeholder:"Enter list of phone numbers in format +1234567890",rows:2,control:d,errors:h})}),(0,i.jsxs)("div",{className:"w-100 form-group",children:[(0,i.jsxs)("label",{className:"form-label",children:["Upload CSV including column ",(0,i.jsx)("strong",{children:"`Numbers`"})]}),(0,i.jsx)("input",{type:"file",className:"form-control",name:"toNumbers",onChange:e=>{const s=e.currentTarget.files[0],a=new FileReader;a.onload=function(e){const s=(e=>{const s={},a=e.split("\n"),t=a[0].split(",").map((e=>e.trim()));t.forEach((e=>{s[e]=[]}));for(let n=1;n<a.length;n++){const e=a[n].split(",");for(let a=0;a<t.length&&a<e.length;a++)s[t[a]].push(e[a].trim())}return null===s||void 0===s?void 0:s.Numbers})(e.target.result),a=s.join("\n");T(s),c("to",a)},a.readAsText(s)}})]}),(0,i.jsx)("div",{className:"w-100",children:(0,i.jsx)(E.Z,{name:"body",placeholder:"Body text",control:d,rows:4,rules:{required:{value:!0,message:"Field required!"}},errors:h})}),(0,i.jsx)("div",{class:"modal-footer ",children:(0,i.jsx)("div",{className:"w-100",children:(0,i.jsx)("button",{class:"btn btn-primary float-end",type:"submit",children:"Send"})})})]})]})})},I=()=>{const e="https://desktopcrm.com:51",{messagesArray:s}=(0,t.useContext)(p.J),[a,n]=(0,t.useState)({}),[o,l]=(0,t.useState)(!1),{messages:r}=(0,f.v9)((e=>e.message)),c=(0,t.useMemo)((()=>(0,k.ZP)(e)),[e]),[u,h]=(0,t.useState)({}),[v,m]=(0,t.useState)([]),[x,g]=(0,t.useState)([]),{user:j,token:b}=(0,f.v9)((e=>e.auth)),[S,C]=(0,t.useState)([]),[A,N]=(0,t.useState)(!1),E=(0,f.I0)();(0,t.useEffect)((()=>{m(r)}),[r]),(0,t.useEffect)((()=>{E((0,w.SN)(b)),E((0,_.D)(b))}),[b,E]),(0,t.useEffect)((()=>{if((null===r||void 0===r?void 0:r.length)>0){let e={},s=[];null===r||void 0===r||r.forEach((a=>{e[a.to_phone]||a.to_phone===(null===j||void 0===j?void 0:j.phone)||a.user_id!==(null===j||void 0===j?void 0:j.id)||"outbound"!==a.direction||(e[a.to_phone]=!0,s.push(a)),e[a.from_phone]||a.from_phone===(null===j||void 0===j?void 0:j.phone)||"inbound"!==a.direction||(e[a.from_phone]=!0,s.push(a))})),g(s)}}),[r,j]),(0,t.useEffect)((()=>{if((null===s||void 0===s?void 0:s.length)>0){let e={},a=[];null===s||void 0===s||s.forEach((s=>{e[s.to_phone]||s.to_phone===(null===j||void 0===j?void 0:j.phone)||s.user_id!==(null===j||void 0===j?void 0:j.id)||(e[s.to_phone]=!0,a.push(s))})),g(a)}}),[s,j]),(0,t.useEffect)((()=>{if((null===s||void 0===s?void 0:s.length)>0){m(s);const e=(null===s||void 0===s?void 0:s.length)>0&&(null===s||void 0===s?void 0:s.filter((e=>e.from_phone===(null===j||void 0===j?void 0:j.phone)&&e.to_phone===(null===u||void 0===u?void 0:u.to_phone)&&e.user_id===(null===j||void 0===j?void 0:j.id)||e.to_phone===(null===j||void 0===j?void 0:j.phone)&&e.from_phone===(null===u||void 0===u?void 0:u.from_phone)&&e.user_id===(null===j||void 0===j?void 0:j.id))));n(e),console.log("\ud83d\ude80 ~ useEffect ~ messagesData:",e)}}),[s,u,j]);const D=e=>{l(e)};return(0,i.jsx)("div",{children:(0,i.jsx)("div",{class:"hk-pg-wrapper pb-0",children:(0,i.jsxs)("div",{class:"hk-pg-body py-0",style:{maxHeight:"100%",overflow:"hidden"},children:[(0,i.jsx)("div",{class:"chatapp-wrap chatapp-info-active",children:(0,i.jsxs)("div",{class:"chatapp-content",children:[(0,i.jsx)(d,{socket:c,rooms:x,a2pVerified:A,messages:v,onFilterDataFromChild:e=>{C(e)},authUser:j,onDataFromChild:e=>{h(e)},onMessagesDataFromChild:e=>{n(e)},onShowAddForm:D}),(null===u||void 0===u?void 0:u.id)&&(0,i.jsx)(y,{messages:v,a2pVerified:A,selectedRoom:u,selectedMessages:a,authUser:j,socket:c})]})}),o&&(0,i.jsx)("div",{class:"emailapp-wrap",children:(0,i.jsx)(T,{onShowAddForm:D,a2pVerified:A})})]})})})},F=()=>(0,i.jsx)("div",{children:(0,i.jsx)(n.Z,{component:(0,i.jsx)(I,{})})})},28022:()=>{}}]);
//# sourceMappingURL=5909.4c8e0f75.chunk.js.map